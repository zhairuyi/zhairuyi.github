<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<!--
***************  *      *     *
      8          *    *       *
      8          *  *         *
      8          **           *
      8          *  *         *
      8          *    *       *
      8          *      *     *
      8          *        *   ***********    -----Theme By Kieran(http://go.kieran.top)
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<!--<![endif]-->

<head>
  <title>myblog | Hexo</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Hexo">
    <meta name="author" content="John Doe">
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <!-- Favicon, (keep icon in root folder) -->
    <link rel="Shortcut Icon" href="/img/favicon.ico" type="image/ico">

    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
    
    <link rel="stylesheet" href="/highlightjs/vs.css" type="text/css">
    

    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->

  
  
  

  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style>
</head>

<!--
<body class="post-template">
-->
<body id="index" class="lightnav animsition">

      <!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close"/>
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            <li>
                <a class="sb-toggle-submenu">Works<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                        <li><a href="/" target="_BLANK" class="animsition-link">AAA</a></li>
                    
                        <li><a href="/atom.xml" target="_BLANK" class="animsition-link">BBB</a></li>
                    
                </ul>
            </li>
            
            
            
            <li>
                <a class="sb-toggle-submenu">Links<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                    <li><a href="http://go.kieran.top/" class="animsition-link">Kieran</a></li>
                    
                    <li><a href="http://domain.com/" class="animsition-link">Name</a></li>
                    
                </ul>
            </li>
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            
            <li><a href="/about.html" class="animsition-link" title="about">About</a></li>
            <li><a href="/atom.xml" class="animsition-link" title="rss">RSS</a></li>
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="/img/logo.png" alt="Logo" width="35px;"/> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">Hexo</a></li>
                            <li class="nolink"><span>Always </span>Creative.</li>
                            
                            <li><a href="https://github.com/" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a></li>
                            
                            
                            <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a></li>
                            
                            
                            <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a></li>
                            
                            
                            <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a></li>
                            
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->


      
<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2019-09-20T01:50:04.000Z" itemprop="datePublished">
          2019-09-20
      </time>
    
    
    | 
    <a href='/tags/myblog/'>myblog</a>
    
    
</span>
                <h1>myblog</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<h1 id="课程-ajax"><a href="#课程-ajax" class="headerlink" title="课程 ajax"></a>课程 ajax</h1><p>ajax是前端开发人员必须要掌握的技能。它并不是一项新技术，应该说是一个比较老的技术了，它主要用于发送异步请求进行页面的局部更新，以提升用户体验。在目前前后端分离开发的大趋势下，ajax成为了前端人员与后端人员交流的手段，分工合作的基础。 </p>
<h2 id="课程整体说明"><a href="#课程整体说明" class="headerlink" title="课程整体说明"></a>课程整体说明</h2><p>我们前一个阶段的学习内容主要是在做<strong>静态页面</strong>，它有两个缺点：</p>
<ul>
<li>网页只能自己看看，别人不能查看。</li>
<li>页面中的数据都是死的，没有活数据。</li>
</ul>
<p>这个阶段，我们引入服务器和ajax的概念来解决这两个问题。</p>
<ul>
<li>使用虚拟web服务器，让其它同学也可以访问我们的网页</li>
<li>通过ajax技术从web服务器上获取活数据</li>
</ul>
<p>目标: </p>
<ul>
<li>能使用第三方的ajax库：jquery，axios；</li>
<li>能手写ajax去访问后端接口；</li>
<li>能使用模板引擎，配合JSON数据进行页面渲染。</li>
</ul>
<p>整体案例展示：</p>
<ul>
<li>留言板</li>
<li>会员管理系统</li>
</ul>
<h2 id="第1章-预备知识"><a href="#第1章-预备知识" class="headerlink" title="第1章 预备知识"></a>第1章 预备知识</h2><h3 id="第1节-服务器与客户端的概念"><a href="#第1节-服务器与客户端的概念" class="headerlink" title="第1节 服务器与客户端的概念"></a>第1节 服务器与客户端的概念</h3><p>上一个阶段的学习内容都是静态网页的技术，没有后端数据参加，也<code>不能共享给其它人来访问</code>。 属于埋头<code>寒窗苦读无人晓</code>的阶段。学习了服务器的知识，我们就可以快速地启一个本地的服务器，让他人来访问我们的网页了</p>
<h4 id="服务器和客户端"><a href="#服务器和客户端" class="headerlink" title="服务器和客户端"></a>服务器和客户端</h4><p>我们在日常上网，聊天的过程中就已经在与服务器与客户端这两个部分打交道了。</p>
<p><strong>服务器(server)</strong></p>
<p>服务器是为其它设备提供服务的机器。生活中的例子：服务员是为顾客提供服务的员工。具体在计算机领域，我们可以理解：</p>
<blockquote>
<p>服务器 = 硬件配置高的电脑 + 安装特殊软件</p>
</blockquote>
<p>它之所以能够提供服务，一方面是硬件性能比较强，另一方面是因为安装了一些特殊的软件：</p>
<ul>
<li>web服务器： 安装了能提供<code>web服务</code>的软件。如iis, nginx, apache等。</li>
<li>ftp服务器：装了ftp软件，提供文件上传下载服务。</li>
<li>数据库服务器：安装了mysql,sql server,mongodb等软件，能够提供数据库服务。</li>
</ul>
<p>有两点要注意：</p>
<ol>
<li>一台服务器可以安装多个软件，来提供多种服务。</li>
<li>服务器是一个相对的概念：如果某台计算机在某个时间给其它设置提供了某个服务，则可以称为它是充当了服务器的功能。例如，你的手机开了热点，别的同学可以通过你的手机来上网，则此时，也可以说你的手机就是一台wifi服务器。</li>
</ol>
<p><strong>客户端（client)</strong><br>连接到服务器，享受服务的设备，就是客户端。一般来说，要<strong>享受某个服务也是需要安装一些软件</strong>的。例如：要想看电影：需要安装爱奇艺客户端软件（或者是通过浏览器软件来访问它的网站）。</p>
<p>在给大家演示留言板的功能时，我的计算机就充当了服务器的角色，而大家的电脑就是享受这个服务的客户端。</p>
<p>要注意这里有两个细节：</p>
<ol>
<li>服务器之所以能提供服务，是因为它安装了特殊的软件，客户端之所以享受服务，也是因为它安装了某些软件。</li>
<li>服务器与客户端是相对的：你也可以把自己的电脑中安装软件器软件，让它也能够为其它同学提供服务。</li>
</ol>
<h3 id="第2节-请求与响应过程"><a href="#第2节-请求与响应过程" class="headerlink" title="第2节 请求与响应过程"></a>第2节 请求与响应过程</h3><h4 id="web请求与响应"><a href="#web请求与响应" class="headerlink" title="web请求与响应"></a>web请求与响应</h4><p>下面我们把<strong>服务器</strong>与<strong>客户端</strong>这两个概念具体到<strong>web服务器</strong>与<strong>浏览器</strong>上来。web服务器就是能提供web服务的服务器，在客户端中，我们要安装浏览器来访问web服务器。</p>
<p>在我们上网的过程中，一般来讲是客户端浏览器主动向web服务器发送请求（可能是通过在浏览器地址栏中直接输入地址，或者是点击了某个超链接），而web服务器收到请求之后将用户需要的请求进行返回。我们把这个过程简化一下：</p>
<ol>
<li>客户端 ——  请求 ——&gt; 服务器</li>
<li>服务器 ——  响应 ——&gt; 客户端<img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568438905809.png" alt="1568438905809"></li>
</ol>
<p>基本流程</p>
<ol>
<li>确认地址。用户在浏览器（客户端）地址栏输入要访问的网站网址（URL）</li>
<li>发送请求。浏览器向服务器发送请求(request)，告知服务器要获取的内容</li>
<li>获取响应。服务端收到浏览器发送的请求，并把处理的结果返回给浏览器(response)</li>
<li>显示内容。浏览器将服务端返回的结果显示到界面上</li>
</ol>
<p>操作</p>
<ul>
<li>在network面板中观察请求</li>
</ul>
<p>注意：<br>如果一个html文件中还引用其它的文件：如样式文件,js文件,图片文件，则会发出多次请求。</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568438967251.png" alt="1568438967251"></p>
<h3 id="第3节-本地web服务器的使用"><a href="#第3节-本地web服务器的使用" class="headerlink" title="第3节 本地web服务器的使用"></a>第3节 本地web服务器的使用</h3><p>为了方便学习，我们会在自己的电脑上安装web服务器软件，把自己的电脑虚拟成web服务器。换句话说，我们的电脑既是客户端，又是服务器。</p>
<p>我们可以安装一些第三方的web服务器软件例如:apche,ngix,iis等。但是为了后期学习的方便，我们这里是使用nodejs技术自己写了一个简单的web服务器，通过它我们就可以体现web服务器的功能了。目前来说，我们不用关心它的具体实现，而只需要学会如何使用它就行了。</p>
<h4 id="虚拟web服务器-访问网页"><a href="#虚拟web服务器-访问网页" class="headerlink" title="虚拟web服务器-访问网页"></a>虚拟web服务器-访问网页</h4><p><code>启动</code><br>   进入目录中，双击 “双击启动”这个文件，会自动弹出小黑窗；</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568440063322.png" alt="1568440063322"></p>
<p><code>访问网页</code></p>
<ul>
<li><p>上传网页到服务器。 把网页文件拷贝到<strong>public</strong>文件夹下。</p>
</li>
<li><p>本机访问：在浏览器中输入地址来访问  <a href="http://localhost:3005/文件名" target="_blank" rel="noopener">http://localhost:3005/文件名</a>  <code>(不要加public)</code></p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568440047436.png" alt="1568440047436"></p>
</li>
<li><p>让其它同学访问： 把localhost改成你的本机的ip地址(关闭本机防火墙)</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568440153144.png" alt="1568440153144"></p>
</li>
</ul>
<h4 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h4><p>在小黑窗服务器中，预置了几个可以用来操作业务，提供数据的特殊的url地址， 就是我们常说的接口。</p>
<p>作为一名前端程序员，我们日常的工作有一个重要的内容，就是调用接口。我们经常会听到类似于这样的对话。</p>
<ul>
<li>开发经理问整体进度：你们组接口调通了几个？</li>
<li>前端程序员对后端程序员说：你的XXX接口有bug，我完全按接口文档上的要求调用的，老是出错。</li>
<li>开发经理问后端程序员说，我们的XX业务要给个接口给隔壁组调用哈，你跟一下哈。</li>
</ul>
<p>上面几组场景中，都涉及了接口这个词， 那么接口是指什么呢？ </p>
<p>这一部分，我们来介绍一些接口的概念，并使用一下小黑窗服务器中几个预置的接口。</p>
<p>我们访问网页的过程，就是浏览器向web服务器发请求，web服务器返回请求内容的过程。我们所请求的资源可以成分成两类：</p>
<ul>
<li><p>文件：图片，css文件，html文件，视频文件等等，这是比较常见的资源，有些场合也称为静态资源。服务器处理这类请求的方式是取出文件的内容，并返回给浏览器。</p>
</li>
<li><p>代码：用服务器端语言写的一段代码，它会执行具体的业务功能，例如，用户登陆，检测用户名等。服务器处理这类请求的方式是执行这段代码，并把结果返回给浏览器。这就是我们上面谈及的接口。</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568439333083.png" alt="1568439333083"></p>
</li>
</ul>
<p>我们可以这么来理解：</p>
<ul>
<li>接口是一个网络url地址，我们通过http协议去访问这个url地址。</li>
<li>接口是由<strong>后端程序员写的一个函数</strong>，它负责接收前端传入的参数（也有可能不需要参数），进行业务处理之后，把处理结果返回给调用这个接口的请求。接口的返回值一般是纯数据。</li>
<li>接口可能有访问权限控制。</li>
<li>在前后端分离开发的背景下，我们可以理解是后端程序员写接口，前端程序员调用接口。</li>
<li>接口一般配合ajax技术来使用。</li>
</ul>
<p>实操：访问虚拟服务器中预置的接口。</p>
<p><code>启动</code><br>   进入目录中，双击 “双击启动”这个文件，会自动弹出小黑窗；</p>
<p><code>访问接口</code></p>
<ul>
<li>对get类型的请求，直接在地址栏中访问</li>
</ul>
<p><code>查看接口文档</code></p>
<ul>
<li>小黑窗服务器的接口文档。</li>
</ul>
<h3 id="第4节-http协议"><a href="#第4节-http协议" class="headerlink" title="第4节 http协议"></a>第4节 http协议</h3><p>浏览器向web服务器发请求的过程就是这两台计算机交流的过程，这个过程中是要遵守一定规则的。这个规则就是http协议。这里我们只是简单了解一下http协议，了解它的组成部分，能够在network面板中查看这些组成部分即可。</p>
<h4 id="什么是http协议"><a href="#什么是http协议" class="headerlink" title="什么是http协议"></a>什么是http协议</h4><p>浏览器与web服务器之间的请求与响应过程是遵守一定的规则的，浏览器向服务器请求什么内容，以什么方式发请求，服务器如何处理这些请求，返回的内容格式是什么，这些细节都有具体的约定，这就是我们要学习的http协议。<br>http(Hypertext transfer protocol)超文本传输协议。<br> 协议 就是规定，就像本朝的法律，必须遵守。http协议的双方就是浏览器和web服务器。http协议规定了通过浏览器和服务器进行数据交互，进行超文本（文本、图片、视频等）传输的规定。<br><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568439107314.png" alt="1568439107314"><br>​<br>HTTP 协议分成两个大的部分： </p>
<ul>
<li><code>请求报文</code> : 浏览器 请求 资源 要遵守的http 协议</li>
<li><code>响应报文</code> : 服务器 返回 资源 要遵守的http 协议   </li>
</ul>
<h4 id="请求报文"><a href="#请求报文" class="headerlink" title="请求报文"></a>请求报文</h4><p>说出请求报文的组成部分，及对应的含义；<br>能在浏览器开发者工具中找出请求报文对应的部分；<br>http协议规定了浏览器向服务器发请求时的格式。</p>
<ul>
<li>它由三个部分组成</li>
</ul>
<ol>
<li><p>请求行</p>
</li>
<li><p>请求头</p>
</li>
<li><p>请求体（可能是空）</p>
<p><code>请求行</code></p>
</li>
</ol>
<p>构成格式： 请求方式  请求路径 协议及版本<br>示例：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> HTTP/1.1</span><br><span class="line"><span class="keyword">GET</span> <span class="string">/index.html</span> HTTP/1.1</span><br><span class="line"><span class="keyword">GET</span> <span class="string">/common/get?id=123&amp;name=jake</span> HTTP/1.1</span><br></pre></td></tr></table></figure>

<p><code>请求头</code></p>
<p>浏览器在向服务器发送请求的时候自动携带的信息，一般不需要主动去设置。</p>
<ul>
<li>信息以键值对格式构成的</li>
</ul>
<table>
<thead>
<tr>
<th>键</th>
<th>值</th>
</tr>
</thead>
<tbody><tr>
<td>Host</td>
<td>请求的主机</td>
</tr>
<tr>
<td>Cache-Control</td>
<td>控制缓存（例如：max-age=60 缓存 60 秒）</td>
</tr>
<tr>
<td>Accept</td>
<td>客户端想要接收的文档类型，逗号分隔</td>
</tr>
<tr>
<td>User-Agent</td>
<td>客户端信息</td>
</tr>
<tr>
<td>Referer</td>
<td>这次请求的来源</td>
</tr>
<tr>
<td>Accept-Encoding</td>
<td>可以接受的压缩编码</td>
</tr>
<tr>
<td>content-type</td>
<td>设置传递给服务器的请求体的格式</td>
</tr>
</tbody></table>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers" target="_blank" rel="noopener">参考链接</a></p>
<p><code>请求体</code><br>请求体中保存本次请求附带的数据，例如，当用户登陆邮箱时，肯定需要把在登陆界面填入的用户名密码这些信息传递给服务器，以做下一步判断。需要注意的是：get请求没有请求体， post请求有请求体。 请求信息发送至服务器以后，服务器会获取传递过来的相关信息进行后端程序的处理。</p>
<h4 id="响应报文"><a href="#响应报文" class="headerlink" title="响应报文"></a>响应报文</h4><p>http协议规定了服务器向浏览器返回数据时的格式。</p>
<ul>
<li>它由三个部分组成</li>
</ul>
<ol>
<li>响应行</li>
<li>响应头</li>
<li>响应体</li>
</ol>
<p><code>响应行</code></p>
<p>格式：  协议及版本 状态码  说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-状态码 ： 用来告诉浏览器服务器处理本次请求的结果。 不同的状态码对应不同的结果。</span><br></pre></td></tr></table></figure>

<p>示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">404</span> Not Found</span><br></pre></td></tr></table></figure>

<p>状态码：</p>
<ul>
<li>描述了请求过程中所发生的情况</li>
<li>每个状态码的第一位数字都用于描述状态的一般类别(“成功”、”出错”等)</li>
<li>常见状态码及含义<ul>
<li>200 - 成功</li>
<li>301 - 资源不在这里</li>
<li>302 - 重定向</li>
<li>304 - 读取缓存</li>
<li>403 - 不能访问</li>
<li>404 - 请求的资源不存在</li>
<li>500 - 服务器内部错误</li>
</ul>
</li>
</ul>
<p>全部状态码参考链接 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status</a></p>
<p><code>响应头</code></p>
<ul>
<li>服务器返回响应的时候携带了附加信息</li>
<li>由键值对组成</li>
<li>每个请求的响应头可能都不一样：它完全取决于服务器；</li>
</ul>
<p>几个常见的响应头</p>
<table>
<thead>
<tr>
<th>键</th>
<th>值</th>
</tr>
</thead>
<tbody><tr>
<td>Date</td>
<td>响应时间</td>
</tr>
<tr>
<td>Server</td>
<td>服务器信息</td>
</tr>
<tr>
<td><strong>Content-Type</strong></td>
<td>响应体的内容类型</td>
</tr>
<tr>
<td>Content-Length</td>
<td>响应的内容大小</td>
</tr>
</tbody></table>
<p><code>响应体</code></p>
<p>本次请求返回的主体内容。根据请求的不同，返回的内容也不同：</p>
<ul>
<li>如果请求的是网页返回网页的内容</li>
<li>如果请求的是图片返回图片的内容</li>
<li>……</li>
</ul>
<h2 id="第2章-认识ajax"><a href="#第2章-认识ajax" class="headerlink" title="第2章 认识ajax"></a>第2章 认识ajax</h2><h3 id="第1节-ajax概述"><a href="#第1节-ajax概述" class="headerlink" title="第1节 ajax概述"></a>第1节 ajax概述</h3><p>ajax是前端实战开发的基本武器，是我们必备技能。本节会带大家看一下ajax的应用场景，体验一下ajax的好处，学习一下ajax的概念。</p>
<h4 id="AJAX的应用场景"><a href="#AJAX的应用场景" class="headerlink" title="AJAX的应用场景"></a>AJAX的应用场景</h4><p>清晰表述ajax的应用场景；能够判断一个网页中是否使用了ajax技术；<br>在<code>不更新页面</code>的情况下（页面有没有更新可以观察浏览器中的后退按钮），浏览器从web服务器获取新数据以更新页面。此时就可以使用ajax技术。</p>
<p>先来对比更新和不更新页面，以分页为例</p>
<ul>
<li>大学的公告页，没有使用AJAX技术：<a href="http://www.whut.edu.cn/tzgg/" target="_blank" rel="noopener">http://www.whut.edu.cn/tzgg/</a></li>
<li>博客园的主页,   使用了AJAX技术：<a href="https://www.cnblogs.com/" target="_blank" rel="noopener">https://www.cnblogs.com/</a></li>
</ul>
<p>分页的目标是从服务器上取出新一页的数据，来更新当前的html，如果使用ajax技术的话，用户的体验会更好一些。 </p>
<p>下面通过网页中的两个案例我们来感受一下：</p>
<ul>
<li>博客页的注册页：<a href="https://account.cnblogs.com/signup" target="_blank" rel="noopener">https://account.cnblogs.com/signup</a></li>
<li>购物网站：<a href="http://www.smzdm.com" target="_blank" rel="noopener">http://www.smzdm.com</a></li>
</ul>
<h4 id="AJAX是什么"><a href="#AJAX是什么" class="headerlink" title="AJAX是什么"></a>AJAX是什么</h4><p>能表述出AJAX是什么<br>AJAX ，全称是：<strong>A</strong>synchronous <strong>J</strong>avaScript <strong>A</strong>nd <strong>X</strong>ml，中文名是： 异步的JavaScript和XML。它是一种创建交互式网页应用的网页开发技术。并不是一种新技术，而是一种解决方案，早在在1998年就开始使用。</p>
<p>下面对其中涉及的概念进行说明：</p>
<ol>
<li><p>async：表示异步。<br>（sync：表示同步 ）。这个单词后面会经常看到到。如何理解异步呢？ 我们可以换一个词： 异步 =====不阻塞： 浏览器在发送ajax请求数据时，并不会阻塞用户后续的操作。理解为浏览器派了一个小弟去服务器拿数据了。以用户名验证为例，你在填入用户名，并离开输入框的那一瞬间，ajax请求就发出去了，这一点可以在network面板中观察到。同时，用户不必等待本次验证的结果是否从服务器中返回，用户还可以继续做后续的操作，例如继续填写地址信息。这个就称为不阻塞。</p>
<p>那么阻塞会是什么情况：用户填入用户名，并鼠标离开输入框的那一瞬间，ajax请求就发出去了，此时界面卡顿，用户不能移动鼠标，不能输入键盘，而必须等待ajax请求回来之后，才能恢复用户的控制。显然阻塞会影响用户的使用感受。</p>
</li>
<li><p>XML表示一种数据格式<br>发ajax请求的目标是为了从web服务器拿回数据，为了方便对数据的后续操作，这个数据最好是符合某个格式规范的。在最初设计AJAX时，从服务器返回的数据是XML格式的，但后面慢慢被JSON数据格式取代了，现在的ajax请求一般求回来的数据都是json格式，但ajax的这个缩写并没有改成ajaj。</p>
</li>
</ol>
<p>更具体来说，<code>浏览器</code>通过内置对象 <code>XMLHttpRequest</code>  向服务器发起请求，并可以接收服务器返回给浏览器的数据，这一过程或实现这一过程的技术就是我们所说的 Ajax。</p>
<h4 id="AJAX的优点"><a href="#AJAX的优点" class="headerlink" title="AJAX的优点"></a>AJAX的优点</h4><p>ajax是一种解决网页局部更新的方案。它有两个明显的好处：</p>
<ol>
<li>局部更新，提升用户体验。</li>
<li>分离开发，提高开发效率。</li>
</ol>
<ul>
<li><p>局部更新，提升用户体验。</p>
</li>
<li><p>分离(前后端分离)开发，提高开发效率。</p>
<ol>
<li>后端同学提供接口。这个接口我们可以理解是一个<code>函数</code>:它的内部进行业务处理，数据库访问等等操作，并返回结果。如何去实现这函数的功能就是后端同学的任务了。</li>
<li>前端同学用ajax技术调用接口获取数据（有其特定的格式），然后再把数据转化成的图文并茂的网页。</li>
</ol>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568449165917.png" alt="1568449165917"></p>
</li>
</ul>
<h2 id="第3章-JQuery中的ajax"><a href="#第3章-JQuery中的ajax" class="headerlink" title="第3章 JQuery中的ajax"></a>第3章 JQuery中的ajax</h2><h3 id="第1节-第一个ajax请求"><a href="#第1节-第一个ajax请求" class="headerlink" title="第1节 第一个ajax请求"></a>第1节 第一个ajax请求</h3><p>本节，我们将使用jQuery框架中封装好的ajax函数来向服务器发送ajax请求。带大家直接认识一下ajax请求是如何发出去的。本节我们重点学习$.ajax的格式，并理解回调函数的概念。</p>
<h4 id="ajax基本使用"><a href="#ajax基本使用" class="headerlink" title="$.ajax基本使用"></a>$.ajax基本使用</h4><p>前面介绍了很多概念：服务器，客户端，web服务器，http协议,ajax等等。现在我们终于可以动手写一个ajax代码了。<br><code>目标任务</code><br>通过jquery库中提供的ajax()方法，发出第一个ajax类型的http请求：获取服务器上的时间，并显示在页面上。</p>
<p><code>前提条件</code><br>web服务器上的接口已经就绪了。</p>
<p>基本流程：</p>
<ol>
<li>新建页面，引入jquery。[空白页 (public/learn/gettime.html)]</li>
<li>点击按钮，发送ajax请求。</li>
</ol>
<p>$.ajax()的基本格式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(</span><br><span class="line">  &#123;</span><br><span class="line">	 url,<span class="comment">//  '/common/getCurrentTime',</span></span><br><span class="line">     type: <span class="string">'get'</span>,<span class="comment">// post</span></span><br><span class="line">     data: &#123;<span class="attr">id</span>:<span class="number">1</span>&#125;,</span><br><span class="line">     success: <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">     	<span class="built_in">console</span>.log(result)</span><br><span class="line">  	 &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<ul>
<li>url : 表示请求的地址，可以省略域名。</li>
<li>type: 表示请求的类型，常见取值 get，post。如果不写，默认为’get’</li>
<li>data: 表示发送请求时附加的参数，如果没有参数，可省略</li>
<li>success：它是一个回调函数。当请求成功之后会自动调用这个函数，它的第一个参数是服务器端返回的数据。</li>
</ul>
<h4 id="ajax中的回调函数"><a href="#ajax中的回调函数" class="headerlink" title="ajax中的回调函数"></a>ajax中的回调函数</h4><p>回调函数(Callback Functions)是学习ajax中的一个重要的概念。<br>两层含义：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- 1. 函数。表示它是一个函数，是可以被执行的，能做具体操作的函数。</span><br><span class="line">- 2. 回调。在某个时刻，或者某个事件发生`自动去调用这个函数`。</span><br></pre></td></tr></table></figure>

<p>通俗来讲，回调函数是<strong>我们自己定义的，供别人调用的函数</strong>，更具体来说，这个函数什么时间会被调用并不由我们来决定，而是”别人”来决定的。 在js中，回调函数通常用于对特定的事件或条件进行响应。 </p>
<p>我们先来看下生活中的例子：<br>陈老板安排小张去给他买咖啡，由于陈老板不知道小张具体什么时间会回来，所以，陈老板跟小张说，“你买回来之后，打电话给我。”  这个场景中就有一个回调函数的应用。</p>
<ul>
<li>回调函数 ：打电话给陈老板。</li>
<li>定义回调函数的人：陈老板。</li>
<li>调用回调函数的人：小张。</li>
<li>调用回调函数的时机：小张买好了咖啡，并回到了公司。</li>
</ul>
<p>代码示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如下均是回调函数的使用</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="comment">// 这是一个匿名函数，我们自己定义的，在它网页DOM结构绘制完毕后就被调用。我们并不知道准确的调用时机。</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$(<span class="string">"#btn"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="comment">// 这是一个匿名函数，我们自己定义的，在按钮点击被调用。我们并不知道用户什么时候点击按钮，所以我们不知道它准确的调用时机。</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ok</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(result);</span><br><span class="line">		 <span class="comment">// 这是一个具名函数，我们自己定义的</span></span><br><span class="line">&#125;</span><br><span class="line">$.ajax(</span><br><span class="line">  url,<span class="comment">//  '/common/getCurrentTime',</span></span><br><span class="line">  &#123;</span><br><span class="line">     type: <span class="string">'get'</span>,<span class="comment">// post</span></span><br><span class="line">     data: &#123;<span class="attr">id</span>:<span class="number">1</span>&#125;,</span><br><span class="line">     success: ok</span><br><span class="line">		 <span class="comment">//ajax请求完成之后，自动调用</span></span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<p>​    一般情况下，回调函数都是匿名函数。但，也是可以给它们起名字的。</p>
<h3 id="第2节-ajax与http和接口"><a href="#第2节-ajax与http和接口" class="headerlink" title="第2节 ajax与http和接口"></a>第2节 ajax与http和接口</h3><p>上一节，我们终于发出去了第一个ajax请求，值得高兴一下。本节我们将暂停写代码的冲动，站在一个观察者的角度，分析一下ajax和http协议和服务器接口之间的关系。</p>
<h4 id="ajax与http协议"><a href="#ajax与http协议" class="headerlink" title="ajax与http协议"></a>ajax与http协议</h4><p>客户端浏览器向web服务器发请求的过程是要遵守http协议中的请求报文的格式的。 ajax请求是http请求的一种，我们可以在network面板中看到这一点。</p>
<p>访问一个使用了ajax技术的网站，打开开发者工具，切换到network面板，学习使用：</p>
<ol>
<li>清除所有请求记录</li>
<li>筛选不同类型的请求:xhr,js,css,img…</li>
<li>观察某个ajax请求的：</li>
</ol>
<ul>
<li>请求行，请求头，请求体；</li>
<li>-应行，响应求，响应体；</li>
</ul>
<ol>
<li>对比普通http请求与ajax请求在响应体上的区别</li>
</ol>
<h4 id="ajax请求与普通请求"><a href="#ajax请求与普通请求" class="headerlink" title="ajax请求与普通请求"></a>ajax请求与普通请求</h4><p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568439714165.png" alt="1568439714165"></p>
<h4 id="ajax与接口"><a href="#ajax与接口" class="headerlink" title="ajax与接口"></a>ajax与接口</h4><ul>
<li>接口是后端同学写好的一个函数，就放在web服务器上的一段代码。这个接口一般就是被别人调用的。在前端同学通过ajax来访问这个接口地址，并获取数据。</li>
<li>ajax请求是http请求的一种，它符合http协议。前端同学使用ajax请求接口，获取数据来实现页面的局部更新。</li>
</ul>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568439834264.png" alt="1568439834264"></p>
<p>你可以使用ajax的方式来调接口，也可以使用普通的http请求来调接口（在地址栏中输入url地址）。它们的区别是:</p>
<p>ajax方式调用接口：</p>
<ul>
<li>控制何时发请求；</li>
<li>控制响应的结果</li>
</ul>
<p>普通http请求调用接口：</p>
<ul>
<li>不能控制何时发请求（浏览器自动控制）</li>
<li>不能处理响应的结果（浏览器自动控制）</li>
</ul>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568433298417.png" alt="1568433298417"></p>
<h3 id="第3节-ajax发请求"><a href="#第3节-ajax发请求" class="headerlink" title="第3节 $.ajax发请求"></a>第3节 $.ajax发请求</h3><h4 id="中的get请求"><a href="#中的get请求" class="headerlink" title="$中的get请求"></a>$中的get请求</h4><p>掌握以get方式发ajax请求的业务场景；<br>仿照<a href="https://account.cnblogs.com/signup" target="_blank" rel="noopener">博客园注册</a>，实现用户名占用检测效果；学习使用带参数的get请求；</p>
<p>分析一下实现的效果：</p>
<ol>
<li>用户在文本框中，输入用户名</li>
<li>当鼠标离开文本框时，去验证用户有效性。这里就涉及blur事件。</li>
<li>提示验证的结果。</li>
</ol>
<ol>
<li>测试接口。直接在地址栏中使用接口（localhost:3005/common/checkname），注意在问号后附加参数的问题</li>
<li>给出静态代码</li>
<li>分析要实现的功能;</li>
<li>介绍$.ajax的参数中的data值</li>
</ol>
<h4 id="中的post请求"><a href="#中的post请求" class="headerlink" title="$中的post请求"></a>$中的post请求</h4><p>掌握以post方式发ajax请求的业务场景；<br>目标：在登陆时，进行用户名密码验证。</p>
<p>用ajax的方式向指定的接口发请求，并根据服务器返回的结果，来决定显示的内容；</p>
<h2 id="如何运行代码"><a href="#如何运行代码" class="headerlink" title="如何运行代码"></a>如何运行代码</h2><ol>
<li><p>启动服务器</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568455183858.png" alt="1568455183858"></p>
</li>
<li><p>写的自己页面，放在public下。</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568455292856.png" alt="1568455292856"></p>
</li>
<li><p>访问这个自己写的文件</p>
<p><a href="http://localhost:3005/test.html" target="_blank" rel="noopener">http://localhost:3005/test.html</a></p>
</li>
</ol>
<p>错误：</p>
<ul>
<li>没有启动服务器</li>
<li>双击打开文件</li>
<li>右键，liveserver：<img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568455383476.png" alt="1568455383476"></li>
<li></li>
</ul>
<h2 id="第4章-案例-留言板"><a href="#第4章-案例-留言板" class="headerlink" title="第4章 [案例]留言板"></a>第4章 [案例]留言板</h2><h3 id="第1节-留言板-效果演示及分析"><a href="#第1节-留言板-效果演示及分析" class="headerlink" title="第1节 留言板-效果演示及分析"></a>第1节 留言板-效果演示及分析</h3><h4 id="留言板-演示及分析"><a href="#留言板-演示及分析" class="headerlink" title="留言板-演示及分析"></a>留言板-演示及分析</h4><p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568463249132.png" alt="1568463249132"></p>
<h3 id="第2节-留言板功能实现"><a href="#第2节-留言板功能实现" class="headerlink" title="第2节 留言板功能实现"></a>第2节 留言板功能实现</h3><h4 id="留言板-获取留言"><a href="#留言板-获取留言" class="headerlink" title="留言板-获取留言"></a>留言板-获取留言</h4><p>在打开网页时，就发一次ajax请求，把留言数据全显示出来。</p>
<p>接口地址：localhost:3009/message/getmsg</p>
<p>获取数据之后，循环：</p>
<ol>
<li>对时间戳进行转换（new Date().to）生成留言对应的html结构</li>
<li>把生成的html结构添加到页面的留言区域中</li>
</ol>
<h4 id="留言板-添加留言"><a href="#留言板-添加留言" class="headerlink" title="留言板-添加留言"></a>留言板-添加留言</h4><p>实现留言的添加功能，在点击添加按钮之后：  </p>
<ol>
<li><p>收集用户的信息，并对信息进行简单的判断。</p>
<p>例如，用户名，内容不能为空.</p>
</li>
<li><p>按接口约定的格式和地址，用$.ajax发出ajax请求，并把留言信息带过去。</p>
</li>
<li><p>根据调用接口的返回结果，来决定是否要</p>
<ul>
<li>重新获取并显示留言</li>
<li>清空发布留言区域</li>
</ul>
</li>
</ol>
<h2 id="第5章-模板引擎"><a href="#第5章-模板引擎" class="headerlink" title="第5章 模板引擎"></a>第5章 模板引擎</h2><h3 id="第1节-模板引擎介绍"><a href="#第1节-模板引擎介绍" class="headerlink" title="第1节 模板引擎介绍"></a>第1节 模板引擎介绍</h3><h4 id="常见模板引擎"><a href="#常见模板引擎" class="headerlink" title="常见模板引擎"></a>常见模板引擎</h4><p>开发网页的过程中，我们会遇到一个典型的问题：如何把从数据库中取回的数据 转化成 html结构？ 这个过程也有一个专门的名称渲染(rending)。举个小例子，你拿到的数据是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var data = &#123;name:&apos;jack&apos;,hobby:[&apos;吃饭&apos;,&apos;睡觉&apos;,&apos;打豆豆&apos;]&#125;</span><br></pre></td></tr></table></figure>

<p>而你要生成的对应的html结构是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;h4&gt;姓名:jack&lt;/h4&gt;</span><br><span class="line">&lt;h4&gt;爱好: 吃饭 睡觉 打豆豆&lt;/h4&gt;</span><br></pre></td></tr></table></figure>

<p>这是一个简单的需求，我们可以直接使用字符串拼接就能够完成。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var htmlStr = &quot;&lt;h4&gt;姓名:&quot;+data.name +&quot;&lt;/h4&gt;&lt;h4&gt;爱好: &quot;+data.hobby[0] +data.hobby[1] +data.hobby[2]&lt;/h4&gt;</span><br></pre></td></tr></table></figure>

<p>当然，还有可能你的结构要复杂一点，例如是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;h4&gt;姓名:jack&lt;/h4&gt;</span><br><span class="line">&lt;dl&gt;</span><br><span class="line">	&lt;dt&gt;爱好&lt;/dt&gt;</span><br><span class="line">	&lt;dd&gt;吃饭&lt;/dd&gt;</span><br><span class="line">	&lt;dd&gt;睡觉&lt;/dd&gt;</span><br><span class="line">	&lt;dd&gt;打豆豆&lt;/dd&gt;</span><br><span class="line">&lt;/dl&gt;</span><br></pre></td></tr></table></figure>

<p>这样，使用字符串做拼接就会比较麻烦了。<br>好的，到此为止，我们面临了两个问题：</p>
<ol>
<li>把一个js对象转成一个html字符串</li>
<li>把同一个js对象转成不同的html字符串</li>
</ol>
<p>我们可以使用一个简单的公式来表达：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html字符串 = 渲染函数(原数据，模板)</span><br></pre></td></tr></table></figure>

<p>这里涉及的技术就是模板引擎。</p>
<p>模板引擎是为了使用户界面与业务数据（内容）分离而产生的，它可以生成特定格式的文档，用于网站的模板引擎就会生成一个标准的文档。</p>
<p>模板引擎的实现方式有很多，最简单的是“置换型”模板引擎，这类模板引擎只是将指定模板内容（字符串）中的特定标记（子字符串）替换一下便生成了最终需要的业务数据（比如网页）。置换型模板引擎实现简单，但其效率低下，无法满足高负载的应用需求（比如有海量访问的网站），因此还出现了“解释型”模板引擎和“编译型”模板引擎等。</p>
<p>模板引擎有很多：</p>
<ul>
<li>baiduTemplate</li>
<li>artTemplate</li>
<li>juicer: <a href="http://juicer.name/或https://github.com/PaulGuo/Juicer/zipball/master#download" target="_blank" rel="noopener">http://juicer.name/或https://github.com/PaulGuo/Juicer/zipball/master#download</a></li>
<li>doT：doT source:<a href="https://github.com/olado/doT" target="_blank" rel="noopener">https://github.com/olado/doT</a> Docs:<a href="http://olado.github.com/doT/" target="_blank" rel="noopener">http://olado.github.com/doT/</a></li>
<li>tmpl</li>
<li>handlebars:<a href="http://handlebarsjs.com/或https://raw.github.com/wycats/handlebars.js/1.0.0-rc.4/dist/handlebars.js" target="_blank" rel="noopener">http://handlebarsjs.com/或https://raw.github.com/wycats/handlebars.js/1.0.0-rc.4/dist/handlebars.js</a></li>
<li>easyTemplate：</li>
<li>underscoretemplate: </li>
<li>mustache:</li>
<li>kissytemplate</li>
</ul>
<p>虽然模板引擎的产品比较多，但它们的使用方法大多是相同的，下面来分别看下 baiduTemplate和artTemplate的使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script id=&quot;tmp&quot; type=&quot;text/html&quot;&gt;</span><br><span class="line">      &lt;h4&gt;姓名:&lt;%= name %&gt;&lt;/h4&gt;</span><br><span class="line">      &lt;dl&gt;</span><br><span class="line">        &lt;% for(var i=0;i&lt; hobby.length;i++) &#123;%&gt;</span><br><span class="line">          &lt;dt&gt;&lt;%= hobby[i] %&gt;&lt;/dt&gt;</span><br><span class="line">        &lt;%&#125;%&gt;</span><br><span class="line">      &lt;/dl&gt;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;./baiduTemplate.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">      var data = &#123; name: &apos;jack&apos;, hobby: [&apos;吃饭&apos;, &apos;睡觉&apos;, &apos;打豆豆&apos;] &#125;;</span><br><span class="line">      console.log(baidu.template(&apos;tmp&apos;, data));</span><br><span class="line">    &lt;/script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script id=&quot;tmp&quot; type=&quot;text/html&quot;&gt;</span><br><span class="line">  &lt;h4&gt;姓名:&#123;&#123;name&#125;&#125;&lt;/h4&gt;</span><br><span class="line">  &lt;dl&gt;</span><br><span class="line">    &#123;&#123;each hobby item&#125;&#125;</span><br><span class="line">      &lt;dt&gt;&#123;&#123;item&#125;&#125;&lt;/dt&gt;</span><br><span class="line">      &#123;&#123;/each&#125;&#125;</span><br><span class="line">  &lt;/dl&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;./template-web.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  var data = &#123; name: &apos;jack&apos;, hobby: [&apos;吃饭&apos;, &apos;睡觉&apos;, &apos;打豆豆&apos;] &#125;;</span><br><span class="line">  console.log(template(&apos;tmp&apos;, data));</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>它们的语法非常像，是吧。基本上，学会了一个，其它的也差不了太多了。</p>
<h3 id="第2节-arttemplate"><a href="#第2节-arttemplate" class="headerlink" title="第2节 arttemplate"></a>第2节 arttemplate</h3><p>我们以arttemplate作为代表，来学习模板引擎的作用。 </p>
<h4 id="artemplate快速使用"><a href="#artemplate快速使用" class="headerlink" title="artemplate快速使用"></a>artemplate快速使用</h4><p>官方文档地址：<a href="https://aui.github.io/art-template/zh-cn/docs/index.html" target="_blank" rel="noopener">https://aui.github.io/art-template/zh-cn/docs/index.html</a></p>
<p>使用步骤</p>
<ol>
<li>引入template-web.js文件</li>
<li>定义模板，注意指定script的id和type属性</li>
<li>准备数据对象。(变量，数组等)</li>
<li>调用template函数，为模板分配数据，获得渲染结果，template的格式如下：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html字符串 = template(模板的id,数据对象)</span><br></pre></td></tr></table></figure>

<p>参考代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 1. 引入template-web.js --&gt;</span><br><span class="line">&lt;script src=&quot;/template-web.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;!-- 2. 定义模板（注意script标签的id和type必须指定） --&gt;</span><br><span class="line">&lt;script id=&quot;tmp&quot; type=&quot;text/html&quot;&gt;</span><br><span class="line">  &lt;h2&gt;&#123;&#123;data&#125;&#125;&lt;/h2&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">   // 3. 编译模板</span><br><span class="line">   //  html字符串 = 模板 + 数据</span><br><span class="line">    var htmlStr = template(&apos;tmp&apos;, &#123;</span><br><span class="line">        data: &apos;hello world&apos;</span><br><span class="line">    &#125;);</span><br><span class="line">    console.log(htmlStr)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h4><p>下面我们详细说明arttemplate的语法。<br>它支持两种语法：</p>
<ul>
<li>标准语法</li>
<li>原始语法</li>
</ul>
<p>以输出变量的值为例，标准语法如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;value&#125;&#125;</span><br><span class="line">&#123;&#123;data.key&#125;&#125;</span><br><span class="line">&#123;&#123;data[&apos;key&apos;]&#125;&#125;</span><br><span class="line">&#123;&#123;a ? b : c&#125;&#125;</span><br><span class="line">&#123;&#123;a || b&#125;&#125;</span><br><span class="line">&#123;&#123;a + b&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>原始语法如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= value %&gt;</span><br><span class="line">&lt;%= data.key %&gt;</span><br><span class="line">&lt;%= data[&apos;key&apos;] %&gt;</span><br><span class="line">&lt;%= a ? b : c %&gt;</span><br><span class="line">&lt;%= a || b %&gt;</span><br><span class="line">&lt;%= a + b %&gt;</span><br></pre></td></tr></table></figure>

<p>下面我们来看两种常见的语法结构：</p>
<ul>
<li>条件</li>
<li>循环</li>
</ul>
<p><code>条件</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 模板写法</span></span><br><span class="line">&lt;script id=<span class="string">"tmp"</span> type=<span class="string">"text/html"</span>&gt;</span><br><span class="line">&#123;&#123;<span class="keyword">if</span> age &gt; <span class="number">18</span>&#125;&#125;</span><br><span class="line">	大于<span class="number">18</span></span><br><span class="line">&#123;&#123;<span class="keyword">else</span>&#125;&#125;</span><br><span class="line">	小于<span class="number">18</span></span><br><span class="line">&#123;&#123;/<span class="keyword">if</span>&#125;&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ template函数写法</span></span><br><span class="line"><span class="regexp">var html = template('tmp', &#123;</span></span><br><span class="line"><span class="regexp">    age: 20</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br></pre></td></tr></table></figure>

<p><code>循环</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 模板写法1</span><br><span class="line">&#123;&#123;each arr&#125;&#125;</span><br><span class="line">	&#123;&#123;$index&#125;&#125; -- 数组的下标</span><br><span class="line">	&#123;&#123;$value&#125;&#125; -- 数组的值</span><br><span class="line">&#123;&#123;/each&#125;&#125;</span><br><span class="line"></span><br><span class="line">// 模板写法2</span><br><span class="line">&#123;&#123;each arr item idx&#125;&#125;</span><br><span class="line">	&#123;&#123;idx&#125;&#125; -- 数组的下标</span><br><span class="line">	&#123;&#123;item&#125;&#125; -- 数组的值</span><br><span class="line">&#123;&#123;/each&#125;&#125;</span><br><span class="line"></span><br><span class="line">// template函数写法</span><br><span class="line">var html = template(&apos;id&apos;, &#123;</span><br><span class="line">    arr: [&apos;apple&apos;, &apos;banana&apos;, &apos;orange&apos;]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="使用外部函数"><a href="#使用外部函数" class="headerlink" title="使用外部函数"></a>使用外部函数</h4><p>如果你希望在模板内部使用模板之外定义的函数，可以以模板变量template.defaults.imports为桥梁，去调用外部的函数。<br>第一步：导入外部函数。这一步相当于把函数挂载在template.defaults.imports对象上。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">function add1(a)&#123;return a+1;&#125;</span><br><span class="line">template.defaults.imports.add1 = add1</span><br></pre></td></tr></table></figure>

<p>第二步：在模板中调用函数<br>模板通过 $imports 可以访问到模板外部的全局变量与导入的变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;% $imports.add1(100) %&gt;</span><br></pre></td></tr></table></figure>

<p><a href="https://aui.github.io/art-template/zh-cn/docs/imports.html" target="_blank" rel="noopener">参考</a></p>
<h2 id="第6章-原生ajax"><a href="#第6章-原生ajax" class="headerlink" title="第6章 原生ajax"></a>第6章 原生ajax</h2><h3 id="第1节-第一个原生ajax"><a href="#第1节-第一个原生ajax" class="headerlink" title="第1节 第一个原生ajax"></a>第1节 第一个原生ajax</h3><p>在实际的开发中，我们会直接使用如jquery这样的第三方工具库来调用ajax，而不会自己去手写一个原生的。但对于学习者来说，深入学习原生ajax能帮助我们更好的理解和掌握一些细节。</p>
<h4 id="原生ajax基本格式"><a href="#原生ajax基本格式" class="headerlink" title="原生ajax基本格式"></a>原生ajax基本格式</h4><p><code>目标</code></p>
<p>写一个原生的AJAX请求，用来获取服务器时间。</p>
<p><code>步骤4步</code></p>
<ol>
<li>new 一个xhr对象</li>
<li>设置请求信息</li>
<li>设置回调函数，处理请求结果</li>
<li>发送请求</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// 第一步： 新建一个XMLHttpRequest对象(xhr)</span><br><span class="line">var xhr = new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">// 第二步： 设置请求。 xhr.open(请求的方式, 请求的url地址);</span><br><span class="line">xhr.open(&apos;get&apos;, &apos;common/getCurrentTime&apos;);</span><br><span class="line"></span><br><span class="line">// 第三步：设置回调函数</span><br><span class="line">// 由于受网络速度及服务器处理请求的耗时不同，我们无法准确得知什么时候请求的数据会回到客户端来，所以，不能在获取在open之后，立即得到</span><br><span class="line">数据，而必须通过回调函数的方式来获取。</span><br><span class="line"></span><br><span class="line">// 打个比方。你想安排一个人去帮你买咖啡，但是，这个人也不知道咖啡店的生意是否需要排队，是否需要打车，几点几分回来，你都不知道，所以，我们会跟他说</span><br><span class="line">// 你回来了，就跟我联系哈。</span><br><span class="line">// 返回的数据存放在xhr.responseText中。</span><br><span class="line"></span><br><span class="line">xhr.onload = function() &#123;</span><br><span class="line">    console.info(&apos;从服务器返回的数据&apos;,    xhr.responseText);</span><br><span class="line">&#125;;</span><br><span class="line">// 第四步： 发送请求。 xhr.send()</span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>

<p><code>理解XMLHttpRequest对象</code></p>
<ul>
<li>ajax的功能是基于XMLHttpRequest对象来实现的。</li>
<li>它是内置对象，充当构造器使用。</li>
<li>浏览器中的network中查看 <code>xhr</code></li>
</ul>
<p>属性和方法：</p>
<ul>
<li>open()</li>
<li>send()</li>
<li>onload(function(){})</li>
<li>responseText</li>
</ul>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest</a></p>
<h3 id="第2节-请求方式"><a href="#第2节-请求方式" class="headerlink" title="第2节 请求方式"></a>第2节 请求方式</h3><h4 id="原生ajax发get请求"><a href="#原生ajax发get请求" class="headerlink" title="原生ajax发get请求"></a>原生ajax发get请求</h4><p>如果get请求需要带参数的，就附加在请求的url地址后面。<br>例如：<code>localhost:3005/getapitest?a=1b=2</code></p>
<p>格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?参数1=值1&amp;参数2=值2&amp;参数3=值3...</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ol>
<li>接口是否需要参数，并不是由调用接口的人（前端）决定的，而是定义这个接口的人(后端)决定的。要按照接口文档要求来使用。</li>
<li>在network中观察参数出现的位置。</li>
</ol>
<ul>
<li>在本次请求的请求行中可以看到</li>
<li>在请求的地址中也可以看到</li>
</ul>
<h4 id="原生ajax发post请求"><a href="#原生ajax发post请求" class="headerlink" title="原生ajax发post请求"></a>原生ajax发post请求</h4><p>请求post类型的接口时，有两点区别：</p>
<ol>
<li>参数写在send方法中</li>
<li>要设置请求头。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. 创建xhr对象</span></span><br><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"><span class="comment">//2. 初始化请求</span></span><br><span class="line">xhr.open(<span class="string">'post'</span>,服务器上接口的地址);</span><br><span class="line"><span class="comment">//3. 设置请求头，固定写法</span></span><br><span class="line">xhr.setRequestHeader(<span class="string">'Content-type'</span>,<span class="string">'application/x-www-form-urlencoded'</span>);</span><br><span class="line"><span class="comment">//4. 监听响应的回调函数</span></span><br><span class="line">xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(xhr.responseText);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//5. 发送请求</span></span><br><span class="line">xhr.send(<span class="string">'提交给服务器数据字符串'</span>);<span class="comment">// 'a=1&amp;b=3'</span></span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ul>
<li>要设置请求头</li>
<li>提交给服务器的数据写在send()中。</li>
</ul>
<h4 id="get和post的区别"><a href="#get和post的区别" class="headerlink" title="get和post的区别"></a>get和post的区别</h4><p>一个接口到底是post类型还是get类型，是由写接口的人员（后端同学）决定的；<br>在前端使用get和post接口时，我们要注意两点：</p>
<ul>
<li>get的参数是url后面可以看到</li>
<li>post的参数是通过http协议的请求体发送的</li>
<li>post请求需要设置请求头（在jquery中的使用$.ajax ()时，它已经悄悄地给我们设置了）</li>
</ul>
<h4 id="其它请求方式"><a href="#其它请求方式" class="headerlink" title="其它请求方式"></a>其它请求方式</h4><p>接口的类型不仅有get,post，还有其它的：</p>
<ul>
<li>get: 获取信息</li>
<li>post: 向服务器提供新数据</li>
<li>put：修改数据</li>
<li>delete：修改数据</li>
<li>options: 测试服务器</li>
</ul>
<p>由后端同学决定接口类型的。<br>在小黑窗服务器中，我们提供了put类型的接口。</p>
<h3 id="第3节-处理服务器的返回值"><a href="#第3节-处理服务器的返回值" class="headerlink" title="第3节 处理服务器的返回值"></a>第3节 处理服务器的返回值</h3><p>通过ajax请求接口返回的数据都是字符串。</p>
<h4 id="三种格式的字符串"><a href="#三种格式的字符串" class="headerlink" title="三种格式的字符串"></a>三种格式的字符串</h4><ul>
<li>普通字符串</li>
<li>JSON字符串</li>
<li>XML字符串</li>
</ul>
<h4 id="JSON字符串"><a href="#JSON字符串" class="headerlink" title="JSON字符串"></a>JSON字符串</h4><p>使用ajax请求接口时，从服务器端返回的数据在格式要统一，这样才能让不同的后端语言，不同的前端人员都能读懂，都方便操作，这里，我们约定使用JSON格式的字符串。</p>
<h5 id="如何判断返回值是JSON字符串"><a href="#如何判断返回值是JSON字符串" class="headerlink" title="如何判断返回值是JSON字符串"></a>如何判断返回值是JSON字符串</h5><p>从服务器返回的数据都是字符串格式的，如何判断数据是JSON字符串格式的？</p>
<p>方法一：在线检测</p>
<p>[在线验证json格式](<a href="http://www.bejson.com/" target="_blank" rel="noopener">http://www.bejson.com/</a>）</p>
<p>方法二：观察response</p>
<p>典型的特征是:</p>
<ul>
<li>长的和js中的对象很像</li>
<li>对象的属性使用了””</li>
</ul>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568472774409.png" alt="1568472774409"></p>
<h5 id="JSON是什么"><a href="#JSON是什么" class="headerlink" title="JSON是什么"></a>JSON是什么</h5><p>JSON:  JavaScript Object Notation(JavaScript 对象表示法) 。 </p>
<ul>
<li>JSON 是一种通过<strong>字符串</strong>描述数据的手段，用于表示有结构的数据。</li>
<li>JSON 是轻量级的文本数据交换格式,类似 XML。</li>
<li>JSON <code>独立于编程语言</code>  （php,java,go,js 都会通过它来进行数据交流）</li>
<li>JSON 具有自我描述性，更易理解</li>
</ul>
<h5 id="JSON字符串相关的两个操作"><a href="#JSON字符串相关的两个操作" class="headerlink" title="JSON字符串相关的两个操作"></a>JSON字符串相关的两个操作</h5><ul>
<li>把JSON字符串转成具体某个编程语言中的数据格式，称为把JSON字符串转成JSON对象。</li>
<li>在某个编程语言中，把数据格式转成JSON字符串。称为把JSON对象转成JSON字符串。</li>
</ul>
<p><img src="../../../../ajax81/day03/00-%E8%AE%B2%E4%B9%89%E5%92%8C%E7%AC%94%E8%AE%B0/ajax%E8%AE%B2%E4%B9%89.assets/1559101747981.png" alt="1559101747981"></p>
<table>
<thead>
<tr>
<th></th>
<th>从JSON字符串转成编程语言支持的数据</th>
<th>从数据类型转成JSON字符串</th>
</tr>
</thead>
<tbody><tr>
<td>js</td>
<td>JSON.parse()</td>
<td>JSON.stringify()</td>
</tr>
<tr>
<td>php</td>
<td>json_decode()</td>
<td>json_encode()</td>
</tr>
<tr>
<td>java</td>
<td>JSON.parseObject(),JSON.parseArray()</td>
<td>JSON.toJSONString</td>
</tr>
</tbody></table>
<p>js中提供了一个静态对象JSON来处理json（它与Math对象相似，不需要new）而是直接通过对象名.方法来调用。</p>
<h5 id="JSON-stringify"><a href="#JSON-stringify" class="headerlink" title="JSON.stringify"></a>JSON.stringify</h5><p>功能：把js数据，转成JSON格式的字符串</p>
<p>格式：<code>var JSON字符串 = JSON.stringify(js数据)</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">'ok'</span>, <span class="string">'hello'</span>];</span><br><span class="line"><span class="keyword">var</span> arr_jsonStr = <span class="built_in">JSON</span>.stringify(arr);</span><br><span class="line"><span class="built_in">console</span>.info(arr, <span class="keyword">typeof</span> arr);</span><br><span class="line"><span class="built_in">console</span>.info(arr_jsonStr, <span class="keyword">typeof</span> arr_jsonStr);</span><br></pre></td></tr></table></figure>

<h5 id="JSON-parse"><a href="#JSON-parse" class="headerlink" title="JSON.parse"></a>JSON.parse</h5><p>功能：把JSON格式的字符串，还原成JS中的数据</p>
<p>格式：<code>var JS数据 = JSON.parse(JSON字符串)</code></p>
<p>小结</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568632745070.png" alt="1568632745070"></p>
<h4 id="XML字符串（简单了解）"><a href="#XML字符串（简单了解）" class="headerlink" title="XML字符串（简单了解）"></a>XML字符串（简单了解）</h4><p>可扩展标记语言（E<strong>x</strong>tensible Markup Language）</p>
<ul>
<li>XML 于 1998 年 2 月 10 日成为 <a href="https://baike.baidu.com/item/W3C" target="_blank" rel="noopener">W3C</a> 的推荐标准。AJAX（异步的javascript和XML）中的 X 就是 XML</li>
<li>它提供了一种描述结构数据的格式，简化了网络中<a href="https://baike.baidu.com/item/数据交换" target="_blank" rel="noopener">数据交换</a>和表示，使得代码、数据和表示分离，并作为数据交换的标准格式。</li>
<li>独立于编程语言的。（php,java,go,js 都会通过它来进行数据交流）</li>
</ul>
<p><code>示例</code></p>
<p>假设这个文件的名字为books.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span><br><span class="line">&lt;booklist&gt;</span><br><span class="line">&lt;book&gt;</span><br><span class="line">	&lt;author&gt;吴承恩&lt;/author&gt;</span><br><span class="line">	&lt;name&gt;西游记&lt;/name&gt;</span><br><span class="line">&lt;/book&gt;</span><br><span class="line">&lt;book&gt;</span><br><span class="line">	&lt;author&gt;施耐庵&lt;/author&gt;</span><br><span class="line">	&lt;name&gt;水浒传&lt;/name&gt;</span><br><span class="line">&lt;/book&gt;</span><br><span class="line">&lt;book&gt;</span><br><span class="line">	&lt;author&gt;罗贯中&lt;/author&gt;</span><br><span class="line">	&lt;name&gt;三国演义&lt;/name&gt;</span><br><span class="line">&lt;/book&gt;</span><br><span class="line">&lt;book&gt;</span><br><span class="line">	&lt;author&gt;曹雪芹&lt;/author&gt;</span><br><span class="line">	&lt;name&gt;红楼梦&lt;/name&gt;</span><br><span class="line">&lt;/book&gt;</span><br><span class="line">&lt;/booklist&gt;</span><br></pre></td></tr></table></figure>

<p><code>操作</code></p>
<p>如果ajax所请求的接口，明确规定返回值是xml格式，你可以通过：</p>
<ul>
<li><p>通过xhr.responseXML来获取内容。</p>
<p><img src="../../../../ajax81/day03/00-%E8%AE%B2%E4%B9%89%E5%92%8C%E7%AC%94%E8%AE%B0/ajax%E8%AE%B2%E4%B9%89.assets/1559112384502.png" alt="1559112384502"></p>
</li>
<li><p>拿到这个内容之后，就像操作dom元素一样去访问其中的内容。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var books = xhr.responseXML.getElementsByTagName(&apos;book&apos;)</span><br><span class="line">for (var index = 0; index &lt; books.length; index++) &#123;</span><br><span class="line">    var element = books[index]</span><br><span class="line">    console.info(element.getElementsByTagName(&apos;author&apos;)[0].innerHTML)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="XML-和-JSON"><a href="#XML-和-JSON" class="headerlink" title="XML 和 JSON"></a>XML 和 JSON</h4><p>相同点：</p>
<ul>
<li>都用来<code>描述数据格式</code></li>
<li>与具体的<code>编程语言无关</code></li>
<li>有自己文件格式的后缀名.xml和.json的文件</li>
</ul>
<p>区别</p>
<ul>
<li>JSON 有简易的语法（javascript基因）；XML有规范的标签（html基因）</li>
<li>JSON存储效率更高</li>
</ul>
<h3 id="第4节-同步异步"><a href="#第4节-同步异步" class="headerlink" title="第4节 同步异步"></a>第4节 同步异步</h3><p>ajax中的第一个字母a表异步的意思。</p>
<h4 id="理解同步异步"><a href="#理解同步异步" class="headerlink" title="理解同步异步"></a>理解同步异步</h4><p>我们通过生活中的例子来理解。</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568474288600.png" alt="1568474288600"></p>
<p>同步方式： 一个时刻只能做一件事；</p>
<ul>
<li>我： 写代码 </li>
<li>我:   买咖啡，自己去买，花2小时</li>
<li>我：写代码</li>
</ul>
<p>异步方式：不是一件做完再做下一件，而是可能同时做多件事情；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- 我： 写代码</span><br><span class="line">- 我： 买咖啡，安排别人去买，跳过这一步，我自己不做。</span><br><span class="line">- 我： 写代码</span><br></pre></td></tr></table></figure>

<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568474335912.png" alt="1568474335912"></p>
<h4 id="ajax中的同步异步"><a href="#ajax中的同步异步" class="headerlink" title="ajax中的同步异步"></a>ajax中的同步异步</h4><p>xhr.open()方法的第三个参数就可以决定同步和异步的方式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.open(类型，地址，是否异步)</span><br></pre></td></tr></table></figure>

<p>默认情况下，第三个参数的值是true，即启用异步模式； 如果设置为false，就是同步模式。</p>
<p>以请求黑盒服务器的接口sleep为例（这个接口已经预先写好了，直接调用即可，地址是localhost:3005/common/sleep），我们来观察效果</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 先输出一行提示代码</span></span><br><span class="line"><span class="built_in">console</span>.info(<span class="string">'1  现在的时间是：'</span>, <span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleTimeString());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 创建ajax，设置，并发送请求</span></span><br><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.open(<span class="string">'get'</span>, <span class="string">'common/sleep'</span>);</span><br><span class="line">xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.info(<span class="string">'2 现在的时间是：'</span>, <span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleTimeString());</span><br><span class="line">&#125;;</span><br><span class="line">xhr.send();<span class="comment">// 发送</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.再输出一行提示代码</span></span><br><span class="line"><span class="built_in">console</span>.info(<span class="string">'3 现在的时间是：'</span>, <span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleTimeString());</span><br></pre></td></tr></table></figure>

<p>改成true和false观察效果。</p>
<p>异步执行流程：</p>
<ul>
<li>浏览器：输出1</li>
<li>浏览器：执行send(),发现是异步的，跳过这一步（不会阻塞代码，理解为：不用自己亲自做，找别人去做）</li>
<li>浏览器：输出3</li>
<li>浏览器：ajax请求返回，执行回调函数，输出2</li>
</ul>
<p>注意：<code>异步ajax时，onload，可以写在send之后</code></p>
<p>同步执行流程：</p>
<ul>
<li>浏览器：输出1</li>
<li>浏览器：执行send(),发现是同步的，阻塞代码</li>
<li>浏览器：ajax请求返回，执行回调函数，输出2</li>
<li>浏览器：输出3</li>
</ul>
<p>设置成了同步的方式，你会在浏览器看到如下的错误信息：</p>
<p><code>[Deprecation] Synchronous XMLHttpRequest on the main thread is deprecated because of its detrimental effects to the end user&#39;s experience. For more help, check https://xhr.spec.whatwg.org/.</code></p>
<p>有几个单词：</p>
<ul>
<li>Synchronous: 同步的</li>
<li>deprecate:反对的，不赞成</li>
<li>detrimental：有害的，不利的</li>
</ul>
<p>翻译一下就是：[deprecation]由于主线程上的同步xmlhttpRequest对最终用户的体验有不利影响，因此不推荐使用它。有关更多帮助，请查看<a href="https://xhr.spec.whatwg.org/" target="_blank" rel="noopener">https://xhr.spec.whatwg.org/</a></p>
<h3 id="第6节-ie兼容性问题"><a href="#第6节-ie兼容性问题" class="headerlink" title="第6节 ie兼容性问题"></a>第6节 ie兼容性问题</h3><h4 id="onreadystatechange及ajax状态码"><a href="#onreadystatechange及ajax状态码" class="headerlink" title="onreadystatechange及ajax状态码"></a>onreadystatechange及ajax状态码</h4><p><code>onload</code> 是 HTML5 （2014年9月）以后新增的事件，一些老的浏览器(ie6,ie7,ie8)对onload是不支持的。通过代码来验证这一点：以下代码在ie6,ie7,ie8中并不能使用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line"></span><br><span class="line">xhr.open(<span class="string">'get'</span>, <span class="string">'common/gettime'</span>)</span><br><span class="line"></span><br><span class="line">xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span></span><br><span class="line"><span class="function">    //<span class="title">onload</span>在低版本的<span class="title">ie</span>中并不能使用。</span></span><br><span class="line"><span class="function">    <span class="title">alert</span>(<span class="params"><span class="string">'ok'</span></span>)</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"><span class="title">xhr</span>.<span class="title">send</span>(<span class="params"></span>)</span></span><br></pre></td></tr></table></figure>

<p>在html5之前，获取服务器返回内容的时候使用的是 <code>onreadystatechange</code>事件，这个事件是在xhr对象状态变化时被触发，而一次请求过程中，<code>XMLHttpRequest</code>对象的状态会发生<code>多次变化</code>，也就意味着这个事件会被触发多次。</p>
<p>onreadystatechange</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">xhr.open(<span class="string">'get'</span>, <span class="string">'common/getCurrentTime'</span>)</span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'事件被触发了'</span>xhr.readyState)</span><br><span class="line">&#125;</span><br><span class="line">xhr.send()</span><br></pre></td></tr></table></figure>

<h4 id="xhr-对象的状态"><a href="#xhr-对象的状态" class="headerlink" title="xhr 对象的状态"></a><code>xhr</code> 对象的状态</h4><p>一共有5种，用<code>readyState</code>属性表示，详见下表</p>
<table>
<thead>
<tr>
<th>readyState</th>
<th>状态描述</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>UNSENT</td>
<td>XHR被创建，但尚未调用 <code>open()</code> 方法。</td>
</tr>
<tr>
<td>1</td>
<td>OPENED</td>
<td><code>open()</code> 方法已经被调用，建立了连接。</td>
</tr>
<tr>
<td>2</td>
<td>HEADERS_RECEIVED</td>
<td><code>send()</code> 方法已经被调用，并且已经可以获取状态行和响应头。</td>
</tr>
<tr>
<td>3</td>
<td>LOADING</td>
<td>响应体下载中， <code>responseText</code> 属性可能已经包含部分数据。</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td><strong>DONE</strong></td>
<td>响应体下载完成，可以直接使用 <code>responseText</code></td>
</tr>
</tbody></table>
<p>一次正常的send()，xhr.readStatus的值的变化是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 -&gt; 1 -&gt; 2 -&gt; 3 -&gt; 4</span><br></pre></td></tr></table></figure>

<h3 id="第7节-ie浏览器对get类型接口缓存问题"><a href="#第7节-ie浏览器对get类型接口缓存问题" class="headerlink" title="第7节 ie浏览器对get类型接口缓存问题"></a>第7节 ie浏览器对get类型接口缓存问题</h3><p>如下代码，在<code>ie</code>中运行：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;button id=<span class="string">"btn"</span>&gt;获取时间&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;label for="" id="lblTimer"&gt;&lt;/</span>label&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">    document.getElementById('btn').onclick = function() &#123;</span></span><br><span class="line"><span class="regexp">    var xhr = new XMLHttpRequest();</span></span><br><span class="line"><span class="regexp">    xhr.open('get', 'common/g</span>etCurrentTime<span class="string">');</span></span><br><span class="line"><span class="string">    xhr.send();</span></span><br><span class="line"><span class="string">    xhr.onreadystatechange = function() &#123;</span></span><br><span class="line"><span class="string">        if (xhr.readyState == 4) &#123;</span></span><br><span class="line"><span class="string">            document.getElementById('</span>lblTimer<span class="string">').innerHTML = xhr.responseText;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<p>第一次点击获取时间，结果是正确的，而之后的结果却保持不变。</p>
<p>出现这个问题的原因：</p>
<ul>
<li>多次<strong>get请求</strong>的接口地址都一样，<strong>ie浏览器</strong>使用了第一次请求的结果来代替之后的请求结果。</li>
<li>后面的请求没有发出去。</li>
</ul>
<p>解决方式：</p>
<ul>
<li>给请求地址中补充一个无效的，随机的参数及值<ul>
<li>无效是指这个参数后端接口不需要</li>
<li>随机是为了保存每次请求的地址都不相同</li>
</ul>
</li>
</ul>
<p>示例：</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568474835105.png" alt="1568474835105"></p>
<h3 id="第8节-ajax异常处理"><a href="#第8节-ajax异常处理" class="headerlink" title="第8节 ajax异常处理"></a>第8节 ajax异常处理</h3><p>在访问接口的过程中，可能出各种异常，如接口不存在，服务器错误等。遇到这些异常时，我们可以进一步进行处理，以提高代码的健壮性。</p>
<h4 id="ajax处理"><a href="#ajax处理" class="headerlink" title="ajax处理"></a>ajax处理</h4><p>通过状态码来处理不同的异常情况。</p>
<p>典型的有:404错误, 500错误。</p>
<h3 id="第9节FormData对象"><a href="#第9节FormData对象" class="headerlink" title="第9节FormData对象"></a>第9节FormData对象</h3><p>（<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/FormData" target="_blank" rel="noopener">官方api参考</a>）</p>
<p>FormData：表单数据。它是用来处理html中与表单数据相关的操作的内置对象。</p>
<p>一个典型的ajax的使用过程， 一般是：</p>
<ol>
<li><strong>收集用户的输入的参数</strong></li>
<li>按接口文档的要求把参数传递到后端接口</li>
<li>根据后端接口的返回值来局部更新页面。</li>
</ol>
<p>以上三个步骤中，我们可以使用FormData来帮助我们收集用户信息这个部分。 </p>
<p>除此之外，它还有一个典型的应用场景:<code>上传文件</code></p>
<h4 id="快速获取表单中的元素值"><a href="#快速获取表单中的元素值" class="headerlink" title="快速获取表单中的元素值"></a>快速获取表单中的元素值</h4><p>假设有一个静态页面如下，它有三项信息要收集起来：姓名，密码，性别。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"myform"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"userName"</span> <span class="attr">name</span>=<span class="string">"userName"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"userPassword"</span> <span class="attr">name</span>=<span class="string">"userPassword"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">""</span>&gt;</span>性别<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">               <span class="attr">type</span>=<span class="string">"radio"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">id</span>=<span class="string">"genderMale"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">name</span>=<span class="string">"userGender"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">value</span>=<span class="string">"male"</span></span></span><br><span class="line"><span class="tag">               /&gt;</span>男</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">               <span class="attr">type</span>=<span class="string">"radio"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">id</span>=<span class="string">"genderFemale"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">name</span>=<span class="string">"userGender"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">value</span>=<span class="string">"female"</span></span></span><br><span class="line"><span class="tag">               /&gt;</span>女</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击注册按钮之后，我们会把这三项数据发送给后端口请口，这里我们的重点不是实现注册功能，我们把注意力放在如何去收集这三项信息上。</p>
<ul>
<li>手动一个一个收集，再拼接</li>
<li>使用formData收集</li>
</ul>
<p><code>不用FormData</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//收集用户信息</span></span><br><span class="line">    <span class="keyword">var</span> userName = <span class="built_in">document</span>.getElementById(<span class="string">'userName'</span>).value;</span><br><span class="line">    <span class="keyword">var</span> userPassword = <span class="built_in">document</span>.getElementById(<span class="string">'userPassword'</span>).value;</span><br><span class="line">    <span class="keyword">var</span> userGender = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">document</span>.getElementById(<span class="string">'genderMale'</span>).checked) &#123;</span><br><span class="line">        userGender = <span class="string">'male'</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.getElementById(<span class="string">'genderFemale'</span>).checked) &#123;</span><br><span class="line">        userGender = <span class="string">'famale'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.info(userName, userPassword, userGender);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过post传值</span></span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    xhr.responseType = <span class="string">'json'</span>;</span><br><span class="line">    xhr.open(<span class="string">'post'</span>, <span class="string">'common/postapitest'</span>);</span><br><span class="line">    xhr.setRequestHeader(</span><br><span class="line">        <span class="string">'Content-type'</span>,</span><br><span class="line">        <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">    );</span><br><span class="line">    xhr.send(</span><br><span class="line">        <span class="string">`userName=<span class="subst">$&#123;userName&#125;</span>&amp;userPassword=<span class="subst">$&#123;userPassword&#125;</span>&amp;userGender=<span class="subst">$&#123;userGender&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">    xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.info(xhr.response);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><code>使用FormData</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//收集用户信息</span></span><br><span class="line">    <span class="keyword">var</span> fd = <span class="keyword">new</span> FormData(<span class="built_in">document</span>.getElementById(<span class="string">'myform'</span>));</span><br><span class="line">    <span class="comment">// 通过post传值</span></span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    xhr.responseType = <span class="string">'json'</span>;</span><br><span class="line">    xhr.open(<span class="string">'post'</span>, <span class="string">'common/postapitest'</span>);</span><br><span class="line">    <span class="comment">// 不用设置请求头 </span></span><br><span class="line">    <span class="comment">// xhr.setRequestHeader(</span></span><br><span class="line">    <span class="comment">//   'Content-type',</span></span><br><span class="line">    <span class="comment">//   'application/x-www-form-urlencoded'</span></span><br><span class="line">    <span class="comment">// );</span></span><br><span class="line">    xhr.send(fd);</span><br><span class="line">    xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.info(xhr.response);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>要注意：</p>
<ul>
<li>FormData对象内部有一个键值对集合，其中的键名就是表单元素的name属性名，而值就是这个表单元素当前的值。</li>
<li>在设置表单元素的name属性值时，要最好与后端接口中需要的参数名一一对应起来。</li>
<li>如果传递的参数是formdata对象，则不需要需要单独设置请求头content-type:application/x-www-form-urlencoded,原因是：它会设置自己的请求头 content-type: application/json。</li>
</ul>
<h4 id="FormData对象的api"><a href="#FormData对象的api" class="headerlink" title="FormData对象的api"></a>FormData对象的api</h4><p>参考地址：<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/FormData" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/FormData</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fd = <span class="keyword">new</span> Formdata();</span><br><span class="line">fd.append(key,value);</span><br><span class="line"><span class="comment">// 向 FormData 中添加新的属性值，如果FormData 对应的属性值存在则覆盖原值，否则新增一项属性值。</span></span><br><span class="line">fd.delete(key);</span><br><span class="line"><span class="comment">// 从 FormData 对象里面删除一个键值对。</span></span><br><span class="line"></span><br><span class="line">fd.get(key)</span><br><span class="line"><span class="comment">//返回在 FormData 对象中与给定键关联的第一个值。</span></span><br><span class="line"></span><br><span class="line">fd.has(key)</span><br><span class="line"><span class="comment">//返回一个布尔值表明 FormData 对象是否包含某些键。</span></span><br><span class="line">fd.set(key,value)</span><br><span class="line"><span class="comment">//给 FormData 设置属性值，如果FormData 对应的属性值存在则覆盖原值，否则新增一项属性值。</span></span><br></pre></td></tr></table></figure>

<h4 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h4><p>文件上传是一个非常常见的需求，例如，用户注册时，提交自己的头像信息。小黑窗服务器已经预置了一个接口可以用来上传文件。接口的地址是：<code>formdata/upload</code></p>
<p>使用这个接口有两点注意：</p>
<ul>
<li>这个接口只能接收formdata对象，并且你上传的文件信息必须是保存在名为<code>file</code>的键中。也就是说<strong>input 的name值必须是file</strong> 。 </li>
<li>小黑窗服务器的根目录下，必须要放置一个<code>upload</code>文件夹。这个文件夹就是用来保存上传的文件的。</li>
</ul>
<p>核心代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"container"</span>&gt;</span><br><span class="line">    &lt;h1&gt;FormData文件上传&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">    &lt;form id="myForm"&gt;</span></span><br><span class="line"><span class="regexp">       &lt;label for=""&gt;请选择你要上传的文件&lt;/</span>label&gt;</span><br><span class="line">       &lt;input type=<span class="string">"file"</span> name=<span class="string">"file"</span> /&gt;</span><br><span class="line">    &lt;<span class="regexp">/form&gt;</span></span><br><span class="line"><span class="regexp">     &lt;button id="btn"&gt;上传&lt;/</span>button&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">   document.getElementById('btn').onclick = function() &#123;</span></span><br><span class="line"><span class="regexp">     var fd = new FormData(document.getElementById('myForm'));</span></span><br><span class="line"><span class="regexp">     var xhr = new XMLHttpRequest();</span></span><br><span class="line"><span class="regexp">     xhr.open('post', 'formdata/u</span>pload<span class="string">');</span></span><br><span class="line"><span class="string">     xhr.onload = function() &#123;</span></span><br><span class="line"><span class="string">       console.info(xhr.responseText);</span></span><br><span class="line"><span class="string">     &#125;;</span></span><br><span class="line"><span class="string">     xhr.send(fd);</span></span><br><span class="line"><span class="string">   &#125;;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="onprogress事件"><a href="#onprogress事件" class="headerlink" title="onprogress事件"></a>onprogress事件</h4><p>我们在上传文件时，还可以使用xhr.upload.onprogress来展示上传进度条的效果。</p>
<p>原理：</p>
<ul>
<li>xhr对象中有一个子对象upload，upload对象中有一个事件 onprogress。</li>
<li>onprogress事件大约每100ms触发一次，其回调函数第一个参数是一个事件对象，这个事件对象中有两个属性 loaded 和 total<ul>
<li>loaded：表示已上传文件的大小</li>
<li>total： 表示文件总大小</li>
</ul>
</li>
</ul>
<p>实现思路：</p>
<ul>
<li><p>制作进度条。</p>
<ul>
<li><p>自己做。使用两层嵌套的div即可：第一层是进度条的外边框，第二层才是进度条。</p>
</li>
<li><p>使用bootstrap[<a href="http://bs4.ntp.org.cn/pages/components.html#striped]" target="_blank" rel="noopener">http://bs4.ntp.org.cn/pages/components.html#striped]</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;progress&quot;&gt;</span><br><span class="line">  &lt;div class=&quot;progress-bar progress-bar-striped&quot; role=&quot;progressbar&quot; style=&quot;width: 10%&quot; aria-valuenow=&quot;10&quot; aria-valuemin=&quot;0&quot; aria-valuemax=&quot;100&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>每次onprogress事件触发时：</p>
<ul>
<li>计算当前已上传文件大小的百分比</li>
<li>根据百分比去重绘进度条长度</li>
</ul>
</li>
</ul>
<p>核心代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(&apos;btn&apos;).onclick = function() &#123;</span><br><span class="line">    var innerDom = document.getElementById(&apos;inner&apos;);</span><br><span class="line">    var fd = new FormData(document.getElementById(&apos;myForm&apos;));</span><br><span class="line">    var xhr = new XMLHttpRequest();</span><br><span class="line">    xhr.open(&apos;post&apos;, &apos;formdata/upload&apos;);</span><br><span class="line">	xhr.onload = function() &#123;</span><br><span class="line">        console.info(xhr.responseText);</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.upload.onprogress = function(ev) &#123;</span><br><span class="line">        console.info(Date.now());</span><br><span class="line">        // 已上传 / 总大小</span><br><span class="line">        console.info((ev.loaded / ev.total) * 100 + &apos;%&apos;);</span><br><span class="line">        // 设置百分比值</span><br><span class="line">        innerDom.style.width = (ev.loaded / ev.total) * 100 + &apos;%&apos;;</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.send(fd);</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="第10节-原生ajax封装"><a href="#第10节-原生ajax封装" class="headerlink" title="第10节 原生ajax封装"></a>第10节 原生ajax封装</h3><p>封装的目标：$.ajax({url,type,data,success:function(){} })</p>
<h4 id="封装1-命名"><a href="#封装1-命名" class="headerlink" title="封装1-命名"></a>封装1-命名</h4><h4 id="封装2-提取type参数"><a href="#封装2-提取type参数" class="headerlink" title="封装2-提取type参数"></a>封装2-提取type参数</h4><h4 id="封装3-提取url和data"><a href="#封装3-提取url和data" class="headerlink" title="封装3-提取url和data"></a>封装3-提取url和data</h4><h4 id="封装4-处理post请求"><a href="#封装4-处理post请求" class="headerlink" title="封装4-处理post请求"></a>封装4-处理post请求</h4><h4 id="封装5-处理回调函数"><a href="#封装5-处理回调函数" class="headerlink" title="封装5-处理回调函数"></a>封装5-处理回调函数</h4><h2 id="第7章-主流ajax库"><a href="#第7章-主流ajax库" class="headerlink" title="第7章 主流ajax库"></a>第7章 主流ajax库</h2><p>在实际开发中，我们一般会采用已经封装好的ajax库来帮助我们去处理ajax请求。</p>
<ul>
<li>jquery</li>
<li>axios</li>
</ul>
<h3 id="第1节-jquery"><a href="#第1节-jquery" class="headerlink" title="第1节 jquery"></a>第1节 jquery</h3><h4 id="ajax"><a href="#ajax" class="headerlink" title="$.ajax"></a>$.ajax</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">  url:&apos;&apos;,</span><br><span class="line">  type: &apos;get&apos;,</span><br><span class="line">  data: &#123; id: 1 &#125;,</span><br><span class="line">  beforeSend: function (xhr) &#123;</span><br><span class="line">    console.log(&apos;before send&apos;)</span><br><span class="line">  &#125;,</span><br><span class="line">  success: function (data) &#123;</span><br><span class="line">    console.log(data)</span><br><span class="line">  &#125;,</span><br><span class="line">  error: function (xhr) &#123;</span><br><span class="line">    console.log(xhr)</span><br><span class="line">  &#125;,</span><br><span class="line">  complete: function (xhr) &#123;</span><br><span class="line">    console.log(&apos;request completed&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>参数介绍 <a href="http://jquery.cuishifeng.cn/jQuery.Ajax.html" target="_blank" rel="noopener">官网地址</a>：</p>
<ul>
<li>url：请求地址</li>
<li>type / method：请求方法，默认为 <code>get</code></li>
<li>data：需要传递到服务端的数据。字符串和对象均可。如果是对象会自动拼接成查询字符串</li>
<li>success：请求成功之后触发</li>
<li>cache: 解决ie浏览器的缓存问题。默认为true，表示缓存。  cache: false 不缓存，会在地址后面补一个_参数。</li>
<li>contentType：发送参数到服务器时，采用的编码类型，默认 <code>application/x-www-form-urlencoded</code></li>
<li>timeout：本次请求最大长时间。以毫秒为单位。如果请求超时，会触发error。</li>
<li>beforeSend：请求发起之前触发</li>
<li>complete：请求完成触发（不管成功与否）</li>
<li>error：function(xhr,)请求失败触发。如果接口返回500错误，它会被触发。</li>
<li>processData:boolean。是否让jquery帮助处理data参数</li>
</ul>
<h4 id="ajax方法的简便用法"><a href="#ajax方法的简便用法" class="headerlink" title="$.ajax方法的简便用法"></a>$.ajax方法的简便用法</h4><ul>
<li>$.get()  </li>
<li>$.post()</li>
<li>$.getJSON()</li>
</ul>
<h5 id="get的格式"><a href="#get的格式" class="headerlink" title="$.get的格式"></a>$.get的格式</h5><p>对于比较简单的get请求，jquery提供了一个快捷方法$.get()</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="keyword">get</span>(url,[,data][,success]);</span><br><span class="line">参数：</span><br><span class="line"> - url     ：字符串方式。指要请求的 URL 地址。</span><br><span class="line"> - data    : js对象，或者字符串方式。 可选的。 指发请求带给服务器的信息。</span><br><span class="line"> - success : function(result)&#123;&#125; 。 可选的。它是一个回调函数，当请求成功时被自动调用，它的第一个参数是从服务器返回的数据。</span><br></pre></td></tr></table></figure>

<h5 id="post的格式"><a href="#post的格式" class="headerlink" title="$.post的格式"></a>$.post的格式</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$.post(url,[,data][,success]);</span><br><span class="line">参数：</span><br><span class="line">- url     ：字符串方式。指要请求的 URL 地址。</span><br><span class="line">- data    : js对象，或者字符串方式。 可选的。 指发请求带给服务器的信息。</span><br><span class="line">- success : function(result)&#123;&#125; 。 可选的。它是一个回调函数，当请求成功时被自动调用，它的第一个参数是从服务器返回的数据。</span><br></pre></td></tr></table></figure>

<h5 id="getJSON"><a href="#getJSON" class="headerlink" title="$.getJSON"></a>$.getJSON</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$.getJSON(url,[,data][,success]);</span><br><span class="line">参数：</span><br><span class="line"> - url     ：字符串方式。指要请求的 URL 地址。</span><br><span class="line"> - data    : js对象，或者字符串方式。 可选的。 指发请求带给服务器的信息。</span><br><span class="line"> - success : <span class="function"><span class="keyword">function</span>(<span class="params">json</span>)</span>&#123;&#125; 。它是一个回调函数，当请求成功时被自动调用，它的参数是从服务器返回的<span class="built_in">JSON</span>数据。</span><br></pre></td></tr></table></figure>

<h3 id="第2节-axios库"><a href="#第2节-axios库" class="headerlink" title="第2节 axios库"></a>第2节 axios库</h3><p>jquery中封装了ajax功能，但是它的体积比较大。如果我们只希望使用ajax功能，而不需要dom操作的话，我们可以选择使用axios库。</p>
<ul>
<li>它比jquery的体积小的多，适用于只需要ajax请求的业务场景；</li>
<li>后期学习前端框架时也会用到；</li>
</ul>
<h4 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h4><p>通过官网查看其使用方法。中文网站：&lt;<a href="http://www.axios-js.com/zh-cn/docs/" target="_blank" rel="noopener">http://www.axios-js.com/zh-cn/docs/</a></p>
<p>与jquery一样，要使用它，必须先引入这个文件。然后就可以按如下的格式去使用了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取服务器的返回值</span></span><br><span class="line">axios.get(<span class="string">'/common/getapitest?id=123'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// res 就是本次请求的信息</span></span><br><span class="line">    <span class="built_in">console</span>.info(res);</span><br><span class="line">    <span class="comment">// 获取 从服务器返回的数据</span></span><br><span class="line">    <span class="built_in">console</span>.info(res.data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">axios.get(<span class="string">'/common/getapitest'</span>, &#123; <span class="attr">params</span>: &#123; <span class="attr">id</span>: <span class="number">123</span>, <span class="attr">name</span>: <span class="string">'jake'</span> &#125; &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// res 就是本次请求的信息</span></span><br><span class="line">    <span class="built_in">console</span>.info(res);</span><br><span class="line">    <span class="comment">// 获取 从服务器返回的数据</span></span><br><span class="line">    <span class="built_in">console</span>.info(res.data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// post请求，不带参数</span></span><br><span class="line">axios.post(<span class="string">'/common/postapitest'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.info(res.data);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// post请求，带参数</span></span><br><span class="line"><span class="comment">// var params = new URLSearchParams();</span></span><br><span class="line"> <span class="comment">// params.append('参数名', '值');</span></span><br><span class="line"> <span class="comment">// params.append('a', '123');</span></span><br><span class="line"><span class="comment">// axios.post('/common/postapitest', params)</span></span><br><span class="line"></span><br><span class="line">axios.post(<span class="string">'/common/postapitest'</span>, &#123; <span class="attr">id</span>: <span class="number">123</span>, <span class="attr">name</span>: <span class="string">'jake'</span> &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.info(res.data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ul>
<li>它对返回值做了一些封装，需要进一步进行解析。</li>
</ul>
<h2 id="第8章-接口软件"><a href="#第8章-接口软件" class="headerlink" title="第8章 接口软件"></a>第8章 接口软件</h2><h3 id="第1节-接口测试软件"><a href="#第1节-接口测试软件" class="headerlink" title="第1节 接口测试软件"></a>第1节 接口测试软件</h3><p>在前后端分离开发的大背景下，前端程序员和后端程序员之间通过接口进行协同工作，这样，接口测试软件必不可少了。</p>
<p>后端程序员：接口是产出物。在交付接口给前端时，必须确保接口是正常工作的。此时使用接口测试软件先对接口进行测试；</p>
<p>前端程序员：调用接口接口完成功能；在使用接口之前，先用接口测试软件先对其进行测试；</p>
<h3 id="第2节-postman的使用"><a href="#第2节-postman的使用" class="headerlink" title="第2节 postman的使用"></a>第2节 postman的使用</h3><h4 id="post基本使用"><a href="#post基本使用" class="headerlink" title="post基本使用"></a>post基本使用</h4><p>基本操作<br>测试get接口</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568793313005.png" alt="1568793313005">测试post接口</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568793447522.png" alt="1568793447522"></p>
<p>高级操作<br>建立项目保存接口；<br>建立对接口的测试样本；</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568793717221.png" alt="1568793717221">导出接口；</p>
<h2 id="第9章-案例-会员管理系统"><a href="#第9章-案例-会员管理系统" class="headerlink" title="第9章 [案例]会员管理系统"></a>第9章 [案例]会员管理系统</h2><h3 id="第1节-演示及分析"><a href="#第1节-演示及分析" class="headerlink" title="第1节 演示及分析"></a>第1节 演示及分析</h3><h3 id="第2节-接口测试"><a href="#第2节-接口测试" class="headerlink" title="第2节 接口测试"></a>第2节 接口测试</h3><p>在开始写代码之前，我们要确保服务器上的接口都是可用的，所以要先对接口进行测试；</p>
<h3 id="第3节-功能实现"><a href="#第3节-功能实现" class="headerlink" title="第3节 功能实现"></a>第3节 功能实现</h3><h4 id="显示会员列表"><a href="#显示会员列表" class="headerlink" title="显示会员列表"></a>显示会员列表</h4><p>基本思路：</p>
<ul>
<li>发ajax请求；</li>
<li>数据回来之后，使用arttemplate来解析内容；</li>
</ul>
<p>实现步骤：</p>
<ul>
<li>引入jquery.js</li>
<li>在网页打开时，发请求。</li>
<li>数据回来之后，用arttemplate来生成对应的成员。</li>
</ul>
<h4 id="查看会员详情"><a href="#查看会员详情" class="headerlink" title="查看会员详情"></a>查看会员详情</h4><p>从主页中点击超链接进行跳转(index.html —&gt; detail.html)</p>
<ul>
<li>整体分析<ul>
<li>流程分析</li>
<li>接口测试</li>
</ul>
</li>
<li>从地址url中取值</li>
<li>发送请求，更新页面元素</li>
</ul>
<h4 id="删除会员"><a href="#删除会员" class="headerlink" title="删除会员"></a>删除会员</h4><p>基本思路：</p>
<ul>
<li>获取要删除的会员的编号；</li>
<li>调用接口去实现删除功能； </li>
</ul>
<p>基本步骤：</p>
<ul>
<li>给每个删除链接上，补充成员id。</li>
<li>给每个删除链接上，补充’href=”javascript:;”‘，这样可以阻止默认的跳转事件。</li>
<li>给弹出框中的删除按钮添加点击事件<ul>
<li>获取上面的label中的id。</li>
<li>发ajax请求,进行删除</li>
</ul>
</li>
</ul>
<p>重点代码：</p>
<ol>
<li>取消a标签的跳转动作</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascirpt:;"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li><p>添加事件委托</p>
<p>问题描述：元素是动态生成的，无法直接给元素添加点击事件。</p>
<p>解决方法：给其父元素添加事件监听。由于元素上的事件具有冒泡特性：在子元素上的点击事件最终也会冒泡到父元素上。所以可以直接在父元素上监听。</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#parent"</span>).on(<span class="string">"click"</span>,<span class="string">".son"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// ....</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="添加会员"><a href="#添加会员" class="headerlink" title="添加会员"></a>添加会员</h4><p><code>文件控件</code></p>
<p>使用文件控件来上传头像文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 只允许看到jpeg图片</span><br><span class="line">&lt;input type=&quot;file&quot; accept=&quot;image/jpeg&quot; /&gt;</span><br><span class="line">// 只允许看到png图片</span><br><span class="line">&lt;input type=&quot;file&quot; accept=&quot;image/png&quot; /&gt;</span><br><span class="line">// 允许所有的图片</span><br><span class="line">&lt;input type=&quot;file&quot; accept=&quot;image/*&quot; /&gt;</span><br></pre></td></tr></table></figure>

<p>其它类型</p>
<table>
<thead>
<tr>
<th><strong>文件类型</strong></th>
<th><strong>accept属性值</strong></th>
<th><strong>类型</strong></th>
</tr>
</thead>
<tbody><tr>
<td>*.asf</td>
<td>allpication/vnd.ms-asf</td>
<td>Advanced Streaming Format</td>
</tr>
<tr>
<td>*.au</td>
<td>audio/basic</td>
<td>AU Audio</td>
</tr>
<tr>
<td>*.css</td>
<td>text/css</td>
<td>Cascading Style Sheets</td>
</tr>
<tr>
<td>*.csv</td>
<td>text/csv</td>
<td>Comma Separated Values</td>
</tr>
<tr>
<td>*.doc</td>
<td>application/msword</td>
<td>MS Word Document</td>
</tr>
<tr>
<td>*.dot</td>
<td>application/msword</td>
<td>MS Word Template</td>
</tr>
<tr>
<td>*.dtd</td>
<td>application/xml-dtd</td>
<td>Document Type Definition</td>
</tr>
<tr>
<td>*.dwg</td>
<td>image/vnd.dwg</td>
<td>AutoCAD Drawing Database</td>
</tr>
<tr>
<td>*.dxf</td>
<td>image/vnd.dxf</td>
<td>AutoCAD Drawing Interchange Format</td>
</tr>
<tr>
<td>*.gif</td>
<td>image/gif</td>
<td>Graphic Interchange Format</td>
</tr>
<tr>
<td>*.htm</td>
<td>text/html</td>
<td>HyperText Markup Language</td>
</tr>
<tr>
<td>*.html</td>
<td>text/html</td>
<td>HyperText Markup Language</td>
</tr>
<tr>
<td>*.jp2</td>
<td>image/jp2</td>
<td>JPEG-2000</td>
</tr>
<tr>
<td>*.jpe</td>
<td>image/jpeg</td>
<td>JPEG</td>
</tr>
<tr>
<td>*.jpeg</td>
<td>image/jpeg</td>
<td>JPEG</td>
</tr>
<tr>
<td>*.jpg</td>
<td>image/jpeg</td>
<td>JPEG</td>
</tr>
<tr>
<td>*.js</td>
<td>text/javascript, application/javascript</td>
<td>JavaScript</td>
</tr>
<tr>
<td>*.json</td>
<td>application/json</td>
<td>JavaScript Object Notation</td>
</tr>
<tr>
<td>*.mp2</td>
<td>audio/mpeg, video/mpeg</td>
<td>MPEG Audio/Video Stream, Layer II</td>
</tr>
<tr>
<td>*.mp3</td>
<td>audio/mpeg</td>
<td>MPEG Audio Stream, Layer III</td>
</tr>
<tr>
<td>*.mp4</td>
<td>audio/mp4, video/mp4</td>
<td>MPEG-4 Audio/Video</td>
</tr>
<tr>
<td>*.mpeg</td>
<td>video/mpeg</td>
<td>MPEG Video Stream, Layer II</td>
</tr>
<tr>
<td>*.mpg</td>
<td>video/mpeg</td>
<td>MPEG Video Stream, Layer II</td>
</tr>
<tr>
<td>*.mpp</td>
<td>application/vnd.ms-project</td>
<td>MS Project Project</td>
</tr>
<tr>
<td>*.ogg</td>
<td>application/ogg, audio/ogg</td>
<td>Ogg Vorbis</td>
</tr>
<tr>
<td>*.pdf</td>
<td>application/pdf</td>
<td>Portable Document Format</td>
</tr>
<tr>
<td>*.png</td>
<td>image/png</td>
<td>Portable Network Graphics</td>
</tr>
<tr>
<td>*.pot</td>
<td>application/vnd.ms-powerpoint</td>
<td>MS PowerPoint Template</td>
</tr>
<tr>
<td>*.pps</td>
<td>application/vnd.ms-powerpoint</td>
<td>MS PowerPoint Slideshow</td>
</tr>
<tr>
<td>*.ppt</td>
<td>application/vnd.ms-powerpoint</td>
<td>MS PowerPoint Presentation</td>
</tr>
<tr>
<td>*.rtf</td>
<td>application/rtf, text/rtf</td>
<td>Rich Text Format</td>
</tr>
<tr>
<td>*.svf</td>
<td>image/vnd.svf</td>
<td>Simple Vector Format</td>
</tr>
<tr>
<td>*.tif</td>
<td>image/tiff</td>
<td>Tagged Image Format File</td>
</tr>
<tr>
<td>*.tiff</td>
<td>image/tiff</td>
<td>Tagged Image Format File</td>
</tr>
<tr>
<td>*.txt</td>
<td>text/plain</td>
<td>Plain Text</td>
</tr>
<tr>
<td>*.wdb</td>
<td>application/vnd.ms-works</td>
<td>MS Works Database</td>
</tr>
<tr>
<td>*.wps</td>
<td>application/vnd.ms-works</td>
<td>Works Text Document</td>
</tr>
<tr>
<td>*.xhtml</td>
<td>application/xhtml+xml</td>
<td>Extensible HyperText Markup Language</td>
</tr>
<tr>
<td>*.xlc</td>
<td>application/vnd.ms-excel</td>
<td>MS Excel Chart</td>
</tr>
<tr>
<td>*.xlm</td>
<td>application/vnd.ms-excel</td>
<td>MS Excel Macro</td>
</tr>
<tr>
<td>*.xls</td>
<td>application/vnd.ms-excel</td>
<td>MS Excel Spreadsheet</td>
</tr>
<tr>
<td>*.xlt</td>
<td>application/vnd.ms-excel</td>
<td>MS Excel Template</td>
</tr>
<tr>
<td>*.xlw</td>
<td>application/vnd.ms-excel</td>
<td>MS Excel Workspace</td>
</tr>
<tr>
<td>*.xml</td>
<td>text/xml, application/xml</td>
<td>Extensible Markup Language</td>
</tr>
<tr>
<td>*.zip</td>
<td>application/zip</td>
<td>Compressed Archive</td>
</tr>
</tbody></table>
<p><code>本地图片预览</code><br>文件控件选中图片后，文件控件中会保存图片信息它的files属性中。files属性是一个数组，如果只选中了一张图片，这张图片就放在files[0]中，如选了多张图片，则类似后推。</p>
<p>对于这些文件信息（本例中的文件就是用户选中的图片），我们通过<code>window.URL.createObjectURL()</code>来创建一个临时的路径，这个路径可能是像这样：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blob:http:<span class="comment">//localhost:3005/fc517910-1300-44f3-a6e8-d52f56f34e4e</span></span><br></pre></td></tr></table></figure>

<p>你可以通过打一个新的浏览器窗口，并在地址栏中输入这个路径来访问这张图片。注意，它只是临时的，如果你关闭了选中图片的网页，这张图片也将会不可访问。</p>
<p>现在，我们拿到这个临时的url赋值给某一个img标签的src即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// input_avatar就是file控件的内容发生变化执行</span></span><br><span class="line">$(<span class="string">'#input_avatar'</span>).change(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// console.log('xxx');</span></span><br><span class="line">    <span class="comment">// 如果没有选择文件，返回</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.files[<span class="number">0</span>]) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> url = URL.createObjectURL(<span class="keyword">this</span>.files[<span class="number">0</span>]);</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// 设置图片的src</span></span><br><span class="line">    $(<span class="string">'#avatar'</span>).attr(<span class="string">'src'</span>, url);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><code>整体实现</code><br>这里的上传不是一个简单的post请求，它其中包含了文件的上传，我们使用FormData对象来上传图片，会员名，会员说明，并使用$.ajax()方法来实现上传操作。</p>
<p>与原生的ajax传递formdata对象不同，在使用$.ajax()上传formdata对象时，要额外补充两个设置：</p>
<ol>
<li>processData:false</li>
</ol>
<p>不需要jquery去处理上传数据</p>
<ol>
<li>contentType:false</li>
</ol>
<p>jquery会自动给post请求设置请求头，content-type:’application-x-www-form-urlencoded’。这种做法在大多数情况下，都是对的，但是，如果提交的数据是formdata，就不需要去设置了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2. 添加会员</span></span><br><span class="line"><span class="comment">// 2.1 给按钮注册事件  注意，这个是提交按钮</span></span><br><span class="line">$(<span class="string">'#btn_add'</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 2.2 获取用户输入的内容，还有用户选择的文件</span></span><br><span class="line">    <span class="comment">// 2.3 FormData  设置请求体，可以提交二进制数据，可以上传文件</span></span><br><span class="line">    <span class="comment">//     xhr.send(formData);</span></span><br><span class="line">    <span class="keyword">var</span> fd = <span class="keyword">new</span> FormData($(<span class="string">"#myform"</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.4 发送请求，添加数据</span></span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        type: <span class="string">'post'</span>,</span><br><span class="line">        url: <span class="string">'/member/add'</span>,</span><br><span class="line">        data: fd,</span><br><span class="line">        processData: <span class="literal">false</span>,</span><br><span class="line">        <span class="comment">// 不设置content-type，而是当设置了formdata上传文件的时候，xhr对象会自动把content-type设置为multipart/form-data;</span></span><br><span class="line">        contentType: <span class="literal">false</span>,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 判断添加是否成功...</span></span><br><span class="line">            <span class="comment">// 2.5 跳转回首页</span></span><br><span class="line">            location.href = <span class="string">'/'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="下拉加载"><a href="#下拉加载" class="headerlink" title="下拉加载"></a>下拉加载</h4><ul>
<li><p>分析加载数据的时机</p>
<p><img src="ajax_%E8%AE%B2%E4%B9%89_2019_9_13_%E4%B8%8B%E5%8D%8811_39_40.assets/1568469077394.png" alt="1568469077394"></p>
</li>
<li><p>基本完成</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">全局变量来记录最大的last值</span><br><span class="line">// 注册滚动的事件</span><br><span class="line">$(window).scroll(function () &#123;</span><br><span class="line">   // 判断当前是否正在加载数据，如果正在加载数据，就不要再次发送请求了</span><br><span class="line">   if (loading) return;</span><br><span class="line">   // 获取文档的高度</span><br><span class="line">  var documentH = $(document).height();</span><br><span class="line">  // 获取浏览器窗口的高度</span><br><span class="line">  var windowH = $(window).height();</span><br><span class="line">  // 文档滚动出去的距离</span><br><span class="line">  var scrollTop = $(document).scrollTop();</span><br><span class="line">  // 判断当前滚动条距离底部的距离是否 &lt;= 100，加载更多数据</span><br><span class="line">  if (documentH - windowH - scrollTop &lt;= 100) &#123;</span><br><span class="line">    // 加载更多</span><br><span class="line">    loadData();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>优化<ul>
<li>不要重复发请求</li>
<li>loading效果</li>
<li>数据全部加载完成之后的处理</li>
</ul>
</li>
</ul>

            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="m-pagination col-md-8 col-md-offset-2 col-sm-24" role="pagination">
    
    
    <a class="pull-right" href="/2019/09/19/hello-world/">
        Hello World0208 →
    </a>
    
</nav>

        <div class="col-md-8 col-md-offset-2 col-sm-24"><script type="text/javascript">
  /**
   * 搜狐畅言
   */

  /*
  document.write('<div id="SOHUCS" sid="' + window.location.pathname.slice(1) + '" ></div>');

  window.onload = function () {
    (function () {
      var appid = 'cytXXXX';
      var conf = 'prod_xxxxxxxxxxxxxxxxx';
      var width = window.innerWidth || document.documentElement.clientWidth;
      var loadJs = function (d, a, id) {
        var c = document.getElementsByTagName("head")[0] || document.head || document.documentElement;
        var b = document.createElement("script");
        b.setAttribute("type", "text/javascript");
        b.setAttribute("charset", "UTF-8");
        b.setAttribute("src", d);
        if (id) {
          b.setAttribute("id", id);
        }
        if (typeof a === "function") {
          if (window.attachEvent) {
            b.onreadystatechange = function () {
              var e = b.readyState;
              if (e === "loaded" || e === "complete") {
                b.onreadystatechange = null;
                a()
              }
            }
          } else {
            b.onload = a
          }
        }
        c.appendChild(b)
      };

      loadJs("https://changyan.sohu.com/upload/changyan.js", function () {
        window.changyan.api.config({
          appid: appid,
          conf: conf
        })
      });
    })();
  }
  */

</script>
</div>
    </div>
</section>


      
<!-- ============================ Footer =========================== -->

<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2014<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Content By John Doe. All Rights Reserved.
                </p>
                <p>Theme By <a href="//go.kieran.top" style="color: #767D84">Kieran</a></p>
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a>&nbsp;</li>
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
</footer>

<!-- ============================ END Footer =========================== -->
      <!-- Load our scripts -->
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };

    resizeHero();

    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$('#intro').find('img').each(function(){
  var alt = this.alt;

  if (alt){
    $(this).after('<span class="caption" style="display:none">' + alt + '</span>');
  }

  $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="gallery" />');
});
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



      
</body>
</html>
